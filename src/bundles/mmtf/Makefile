TOP	= ../../..
include $(TOP)/mk/config.make
include ../Makefile.bundle

CSRCS = $(wildcard _mmtf/*.cpp)
HEADERS = $(MMTF_CPP_SOURCE) $(MSGPACK_SOURCE)

MMTF_CPP_VERSION = master
MMTF_CPP_DISTRIBUTION = mmtf-cpp-$(MMTF_CPP_VERSION).zip
MMTF_CPP_SOURCE	= mmtf-cpp-$(MMTF_CPP_VERSION)
MSGPACK_VERSION = master
MSGPACK_DISTRIBUTION = msgpack-c-$(MSGPACK_VERSION).zip
MSGPACK_SOURCE	= msgpack-c-$(MSGPACK_VERSION)

CLEAN_ALWAYS = $(MMTF_CPP_SOURCE) $(MSGPACK_SOURCE)

build wheel install app-install:	$(CSRCS) $(HEADERS)

$(MMTF_CPP_SOURCE): $(MMTF_CPP_DISTRIBUTION)
	# only need the include files
	unzip -u $(MMTF_CPP_DISTRIBUTION) '$(MMTF_CPP_SOURCE)/include/**'

$(MMTF_CPP_DISTRIBUTION):
	$(FETCH_PREREQ) $(PREREQS_ARCHIVE)/mmtf/$(MMTF_CPP_DISTRIBUTION)

$(MSGPACK_SOURCE): $(MSGPACK_DISTRIBUTION)
	# only need the include files
	unzip -u $(MSGPACK_DISTRIBUTION) '$(MSGPACK_SOURCE)/include/**'

$(MSGPACK_DISTRIBUTION):
	$(FETCH_PREREQ) $(PREREQS_ARCHIVE)/mmtf/$(MSGPACK_DISTRIBUTION)

upload_new_version:
	$(RSYNC) $(MMTF_CPP_DISTRIBUTION) $(MSGPACK_DISTRIBUTION) $(PREREQS_UPLOAD)/mmtf
