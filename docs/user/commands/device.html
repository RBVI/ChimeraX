<html>

<!--
=== UCSF ChimeraX Copyright ===
Copyright 2016 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  For details see:
http://www.rbvi.ucsf.edu/chimerax/docs/licensing.html
This notice must be embedded in or attached to all copies,
including partial copies, of the software or any revisions
or derivations thereof.
=== UCSF ChimeraX Copyright ===
-->

<head>
<link rel="stylesheet" type="text/css" href="../userdocs.css" />
<title>Command: device, vr</title>
</head><body>

<a name="top"></a>
<a href="../index.html">
<img width="60px" src="../ChimeraX-docs-icon.svg" alt="ChimeraX docs icon"
class="clRight" title="User Guide Index"/></a>

<h3><a href="../index.html#commands">Command</a>: device, vr</h3>

<h3 class="usage"><a href="usageconventions.html">Usage</a>:
<br><b>device</b> &nbsp;<i>device-type</i> [&nbsp;<i>status</i>&nbsp;] 
&nbsp;<i>device-options</i>
</h3>
<p>
The <b>device</b> command sets modes for certain external devices, 
where the <i>device-type</i> can be:
</p>
<ul>
<li><a href="#snav"><b>snav</b></a> 
&ndash; SpaceNavigator<sup>&reg;</sup> 3D mouse
<li><a href="#vr"><b>vr</b></a>
&ndash; HTC Vive, Oculus Rift, Samsung Odyssey virtual reality systems
  <ul>
  <li>the <a href="#vr-button"><b>vr button</b></a> subcommand
  assigns functions to hand controller buttons
  </ul>
</ul>
<p>
<a name="status"></a>
The <i>status</i> of a mode can be 
<b>on</b> (synonyms <b>true</b>, <b>True</b>, <b>1</b>)
or <b>off</b> (synonyms <b>false</b>, <b>False</b>, <b>0</b>).
Device-specific options are described below.
</p>

<a href="#top" class="nounder">&bull;</a>
<a name="snav"><b>device snav</b></a>
[&nbsp;<a href="#status"><i>status</i></a>&nbsp;]
[&nbsp;<b>fly</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<b>speed</b>&nbsp;&nbsp;<i>factor</i>&nbsp;]
<blockquote>
<p>
The command <b>device snav</b> enables manipulation 
with a SpaceNavigator<sup>&reg;</sup> 3D mouse from
<a href="http://www.3dconnexion.com/" target="_blank">3Dconnexion</a>.
The <b>fly</b> option indicates whether the force applied to the device 
should be interpreted as acting on the camera (<b>true</b>), where
pushing forward zooms in because it moves the camera viewpoint toward the scene,
or as acting on the models in the scene (<b>false</b>, default), where
pushing forward zooms out because it pushes the models away.
In either case, however, it is the camera that actually moves.
The <b>speed</b> option sets a sensitivity <i>factor</i> for motion
relative to the device (default <b>1.0</b>).
Decreasing the value (for example, to 0.1) reduces sensitivity to give
slower motion, whereas increasing the value has the opposite effect.
See also: <a href="ui.html#mousemode"><b>mousemode</b></a>
</p>
</blockquote>

<a href="#top" class="nounder">&bull;</a>
<a name="vr"><b>vr</b></a> [&nbsp;<a href="#status"><i>status</i></a>&nbsp;]
[&nbsp;<b>display</b>&nbsp;&nbsp;<b>mirror</b>&nbsp;|&nbsp;independent&nbsp;|&nbsp;blank&nbsp;]
[&nbsp;<b>showControllers</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
[&nbsp;<b>clickRange</b>&nbsp;&nbsp;<i>r</i>&nbsp;]
[&nbsp;<b>gui</b>&nbsp;&nbsp;<i>tool-list</i>&nbsp;]
[&nbsp;<b>toolbarPanels</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
[&nbsp;<b>simplifyGraphics</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
[&nbsp;<b>multishadowAllowed</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<b>roomPosition</b>&nbsp;&nbsp;<i>matrix</i>&nbsp;|&nbsp;<b>report</b>&nbsp;]
<blockquote>
<p>
The <b>vr</b> command (same as <b>device vr</b>)
enables a virtual reality mode for systems supported by
<a href="http://store.steampowered.com/about/"
target="_blank">SteamVR</a>, including HTC Vive, Oculus Rift,
and Samsung Odyssey. SteamVR must be installed separately by the user
and started before the mode is enabled.
In addition, Oculus Rift users should start the Oculus runtime 
before starting SteamVR. For details and related issues, 
see <a href="../vr.html">ChimeraX virtual reality</a>.
See also: 
<a href="#vr-button"><b>vr button</b></a>,
<a href="meeting.html"><b>meeting</b></a>,
<a href="camera.html"><b>camera</b></a>,
<a href="view.html"><b>view</b></a>,
<a href="../movies.html">making movies</a>
<p>
The <b>display</b> option indicates what to show in the ChimeraX graphics
window on the desktop:
<ul>
<li><b>mirror</b> (default) &ndash; the right-eye view seen in the VR headset,
with <a href="graphics.html#waitForVsync"><b>graphics waitForVsync</b></a>
automatically set to false so that VR rendering will not slow down
to the desktop rendering rate
<li><b>independent</b> &ndash; a separate camera view
fixed in the VR room coordinates, set to match the viewpoint of
the VR headset when the command is issued
<li><b>blank</b> &ndash; no graphics, allowing all graphics computing
resources to be dedicated to VR headset rendering
</ul>
Updating the graphics window can cause flicker in the VR headset
because refreshing the computer display (nominally 60 times per second)
slows rendering to headset. ChimeraX turns off syncing to
vertical refresh if possible. Another way to mirror is to use
SteamVR's menu entry to display mirror window.
</p><p>
The <b>showControllers</b> option (default <b>true</b>)
shows representations of the hand controllers in the scene.
Not showing the representations may be useful to avoid time-consuming
calculations of the shadows they cast. 
<p><p>
The <b>clickRange</b> option sets the depth range for
picking objects with the hand-controller cones, where <i>r</i>
(default <b>5.0</b>) is the maximum distance from the tip of the cone 
to the object in scene distance units, typically &Aring;.
Limiting the range prevents accidentally picking far-away objects.
</p><p>
The <b>gui</b> option specifies what tools are shown as a control panel in VR
when the Vive hand-controller
<a href="https://www.vive.com/us/support/vive/category_howto/about-the-controllers.html"
target="_blank">menu button</a> (similar for other systems) is pressed.
By default, the icon <a href="../tools/toolbar.html"><b>Toolbar</b></a>
and all of the righthand tools in the ChimeraX desktop window are shown.
However, any other combination of the current <i>tools</i> can be specified as:
</p>
<ul>
<li><b>main window</b> &ndash; the entire ChimeraX desktop window
<li><b>right panels</b> 
&ndash; all tools in the right side of the ChimeraX desktop window
<li><i>tool1[,tool2 ...]</i> &ndash; a comma-separated list of one or more
tool names (as listed in the <b>Tools</b> menu and shown for most tools in 
their title bars), possibly including <b>right panels</b> as described above. 
Tools may also be custom panels created with the
<a href="buttonpanel.html"><b>buttonpanel</b></a> command.
</ul>
<p>
The default corresponds to:
<b>gui&nbsp;"<a href="../tools/toolbar.html">Toolbar</a>,&nbsp;right&nbsp;panels"</b>
</p><p>
The <b>toolbarPanels</b> option (default <b>true</b>)
applies only to the old toolbars that were handled as separate tools; 
it specifies whether to convert them into righthand panels for use in VR. 
The new <a href="../tools/toolbar.html"><b>Toolbar</b></a>
is shown by default, as described above.
</p><p>
The <b>simplifyGraphics</b> option (default <b>true</b>)
reduces the maximum level of detail in VR by limiting the 
total atom and bond triangles to one million each.
This helps to maintain full rendering speed. The previous total-triangle 
limits are restored when the VR mode is turned off. Normally,
the maximum atom and bond triangles are set to five million each.
See also: <a href="graphics.html"><b>graphics</b></a>
</p><p>
Ambient shadowing or &ldquo;ambient occlusion&rdquo;
requires calculating shadows from multiple directions,
which may make rendering too slow for VR and cause stuttering in the headset.
By default (<b>multishadowAllowed</b> &nbsp;<b>false</b>),
if the <a href="lighting.html#multiShadow"><b>multiShadow</b></a>
lighting parameter is &gt; 0, enabling VR switches to the
<a href="lighting.html#preset"><b>simple</b></a> lighting mode.
With <b>multishadowAllowed</b> &nbsp;<b>true</b>, 
the lighting mode is left unchanged.
</p><p>
When the mode is enabled, the <b>roomPosition</b> option can be used to
specify the transformation between room coordinates (in meters, 
with origin at room center) and scene coordinates (typically in &Aring;)
or to simply <b>report</b> the current transformation
in the <a href="../tools/log.html"><b>Log</b></a>.
The transformation <i>matrix</i> is given as
12 numbers separated by commas only, corresponding to a 3x3 matrix 
for rotation and scaling, with a translation vector in the fourth column.
Ordering is row-by-row, such that the translation vector is given as 
the fourth, eighth, and twelfth numbers. Example:
</p>
<blockquote>
<b>vr &nbsp;room &nbsp;20,0,0,0,0,20,0,0,0,0,20,0</b>
</blockquote>
<p>
The frequency of <a href="label.html#orient">label reoriention</a>
is automatically decreased when VR is enabled and 
restored when VR is turned off.
</p>
</blockquote>

<a href="#top" class="nounder">&bull;</a>
<a name="vr-button"><b>vr button</b></a> 
&nbsp;<i>button-name</i>
&nbsp;<i>function</i>
[&nbsp;<b>hand</b>&nbsp;&nbsp;left&nbsp;|&nbsp;right&nbsp;]
<blockquote>
<table class="clRight" cellspacing="0">
<tr><td>
<a href="tutorials/dicom-vr3.png">
<img class="outline" src="../tutorials/dicom-vr3.png" title="click to enlarge..."
alt="Vive hand controllers" width="300px"></a>
</td></tr>
<tr><td align="center"><font size="-1">
<a href="https://www.vive.com/us/support/vive/category_howto/about-the-controllers.html" target="_blank">Vive</a> hand controllers
</font></td></tr>
</table>
<p>
The <b>vr button</b> command assigns modes (functions) to 
the hand-controller buttons in <a href="../vr.html">virtual reality</a>.
The available <a href="ui.html#functions"><i>function</i></a> names
are the same as for <a href="ui.html#mousemode"><b>mousemode</b></a>
(command <a href="usage.html"><b>usage</b></a> <b>mousemode</b>
lists them in the <a href="../tools/log.html"><b>Log</b></a>)
and should be enclosed in quotation marks if they contain spaces.
The <b>hand</b> option can be given to assign a function 
to the specified button of only one hand controller; 
otherwise, those on both controllers will be assigned.
The <i>button-name</i> can be:
</p>
<ul>
<li><b>trigger</b>
<li><b>grip</b>
<li><b>touchpad</b> 
&ndash; Vive touchpad (trackpad)
<li><b>menu</b>
&ndash; Vive menu button
<li><b>A</b> 
&ndash; a button on the Oculus right hand controller
(<b>hand</b> option ignored)
<li><b>B</b>
&ndash; a button on the Oculus right hand controller
(<b>hand</b> option ignored)
<li><b>X</b>
&ndash; a button on the Oculus left hand controller
(<b>hand</b> option ignored)
<li><b>Y</b>
&ndash; a button on the Oculus left hand controller
(<b>hand</b> option ignored)
</ul>
<p>
Initial defaults are to <b>translate</b> and <b>rotate</b> with triggers,
<b>zoom</b> with Vive touchpad or Oculus A/X button,
and show the ChimeraX control panel with the Vive menu or Oculus B/Y button
(<a href="../vr.html#default-controller">more...</a>).
</p>
</blockquote>

<hr>
<address>UCSF Resource for Biocomputing, Visualization, and Informatics / 
September 2019</address>
</body></html>
