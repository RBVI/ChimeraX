<html>

<!--
=== UCSF ChimeraX Copyright ===
Copyright 2016 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  For details see:
http://www.rbvi.ucsf.edu/chimerax/docs/licensing.html
This notice must be embedded in or attached to all copies,
including partial copies, of the software or any revisions
or derivations thereof.
=== UCSF ChimeraX Copyright ===
-->

<head>
<link rel="stylesheet" type="text/css" href="../userdocs.css" />
<title>Command: volume</title>
</head><body>

<a name="top"></a>
<a href="../index.html">
<img width="60px" src="../ChimeraX-docs-icon.svg" alt="ChimeraX docs icon"
class="clRight" title="User Guide Index"/></a>

<h3><a href="../index.html#commands">Command</a>: volume</h3>

<h3 class="usage"><a href="usageconventions.html">Usage</a>:
<br><b>volume</b>
&nbsp;<a href="atomspec.html#hierarchy"><i>model-spec</i></a>&nbsp;
&nbsp;<a href="#options"><i>options</i></a></h3>
<p>
The <b>volume</b> command controls the display of density maps and
other <a href="../tools/volumeviewer.html">volume data</a>, 
<i>i.e.</i>, values associated with points on a 3D grid.
The <a href="atomspec.html#hierarchy"><i>model-spec</i></a>
can be a specific model number or range of model numbers (preceded by #),
or the word <b>all</b> to indicate all volume models.
The <a href="atomspec.html#hierarchy"><i>model-spec</i></a>
can be omitted for certain options that can or must apply globally,
namely <a href="#pickable"><b>pickable</b></a> and several of the
<a href="#sampling">sampling and size options</a>.
</p><p>
The corresponding graphical interface,
<a href="../tools/volumeviewer.html"><b>Volume Viewer</b></a>,
allows adjusting contour levels and some of the other settings interactively. 
Contour levels can also be changed interactively with the
<a href="ui.html#mousemode">mouse mode</a> for <b>contour level</b>
<a href="../tools/mousemodes.html" title="Right Mouse Toolbar...">
<img class="icon" border=1 src="../tools/mouse-icons/contour.png"></a>
or <b>windowing</b> <a href="../tools/mousemodes.html#multiwindowing" 
title="Right Mouse Toolbar...">
<img class="icon" border=1 src="../tools/mouse-icons/windowing.png"></a>.
</p><p>
Volume data can be opened with the command
<a href="open.html"><b>open</b></a> (which automatically starts 
<a href="../tools/volumeviewer.html"><b>Volume Viewer</b></a>)
and saved to a file with <a href="save.html"><b>save</b></a>.
By default, a data set will be displayed automatically if it does not exceed
a certain size, and the initial display may be as an isosurface or as a
single plane (<a href="#sampling">details...</a>).
Many settings for newly opened data, including the size limits
controlling these behaviors, can be customized with the
<a href="#defaultvalues"><b>volume defaultvalues</b></a> command.
</p><p>
The initial contour level of an isosurface is set to enclose 1% of grid points,
except for maps opened by <a href="open.html#fetch">EMDB fetch</a>,
which will be shown at the depositor-recommended contour level, if any. 
For single-plane display, the middle plane along Z is shown initially with a 
linear ramp in grayscale from the 10th (black) to 99th (white) percentile
of values. 
</p><p>
Data set statistics, isosurface-enclosed volumes, and map-map correlation
values can be reported with <a href="measure.html"><b>measure</b></a>.
See also:
<a href="show.html"><b>show</b></a>,
<a href="color.html"><b>color</b></a>,
<a href="transparency.html"><b>transparency</b></a>,
<a href="vseries.html"><b>vseries</b></a>,
<a href="molmap.html"><b>molmap</b></a>,
<a href="fitmap.html"><b>fitmap</b></a>,
<a href="resfit.html"><b>resfit</b></a>,
<a href="surface.html#sop"><b>surface</b> operations</a>,
<a href="sym.html"><b>sym</b></a>,
<a href="smoothlines.html"><b>smoothlines</b></a>,
<a href="segmentation.html"><b>segmentation</b></a>,
<a href="../tools/densitymaps.html"><b>Map</b></a> icons,
<a href="../tools/medicalimage.html"><b>Medical Image</b></a> icons,
<a href="../measurements.html">measurements</a>,
<a href="../dicom-quickref.html">ChimeraX DICOM Reference</a>
</p>
<a name="examples">Examples</a>:
<blockquote>
<b>volume #1 style mesh level 0.8 color red level 1.2 color 0,50,80</b>
<br>
<b>volume #2 level 10,0 level 100,1 level 400,1 color hot pink style image</b>
<br>
<b>vol all hide</b>
<br>
<b>vol channels #2-8</b>
<br>
<b>vol settings #1</b>
<br>
<b><a href="#defaultvalues">vol defaultvalues</a>
limitVoxelCount false saveSettings true</b>
<br>
<b><a href="#defaultvalues">vol default</a> reset true</b>
</blockquote>
<p>
<a name="channels"></a>
The command <b>volume channels</b> (followed by a <i>model-spec</i>,
as in the example <a href="#examples">above</a>)
groups the specified volume models into a single
<a href="../tools/volumeviewer.html#multichannel">multichannel</a>
data set, where changing the display style, step size, crop boundaries,
or display plane of one channel
in the <a href="../tools/volumeviewer.html"><b>Volume Viewer</b></a>
interface or <a href="ui.html#mousemode">with the mouse</a>
changes it for all of the channels in the group.
The channels are grouped as submodels of a single higher-level model.
Settings for the individual channels can still be changed independently with
other options of the <b>volume</b> command.
</p><p>
<a name="settings"></a>
The command <b>volume settings</b> (optionally followed by a <i>model-spec</i>) 
reports the current volume display settings in the 
<a href="../tools/log.html"><b>Log</b></a>.
See also: <a href="info.html"><b>info</b></a>
</p>
<a name="options"></a>
The <b>volume</b> command has many further options, 
here grouped into categories:
<blockquote><b>
<a href="#general">General Display Options</a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/showmap.png"></a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/hidemap.png"></a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/mapsurf.png"></a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/mesh.png"></a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/mapimage.png"></a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/icecube.png"></a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/outlinebox.png"></a>
<br><a href="#sampling">Sampling and Size Options</a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/step1.png"></a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/step2.png"></a>
<br><a href="#dimensions">Dimension and Scale Options</a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/fullvolume.png"></a>
<br><a href="#planes">Planes Options</a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/plane.png"></a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/orthoplanes.png"></a>
<br><a href="#dispsurf">Surface and Mesh Display Options</a>
<br><a href="#dispsolid">Image Display Options</a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/slab.png"></a>
<a href="../tools/medicalimage.html" title="Medical Image Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/xyzslice.png"></a>
<a href="../tools/medicalimage.html" title="Medical Image Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/perpslice.png"></a>
<a href="../tools/medicalimage.html" title="Medical Image Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/airways.png"></a>
<a href="../tools/medicalimage.html" title="Medical Image Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/chest.png"></a>
<a href="../tools/medicalimage.html" title="Medical Image Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/brain.png"></a>
<a href="../tools/medicalimage.html" title="Medical Image Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/initialcurve.png"></a>
<br><a href="#defaultvalues">Setting Defaults for New Maps</a>
<br><a href="#vop">Volume Operations (Map Editing)</a>
<a href="../tools/mousemodes.html" title="Right Mouse Toolbar...">
<img class="icon" border=1 src="../tools/mouse-icons/eraser.png"></a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/smooth.png"></a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/diffmap.png"></a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/volzone.png"></a>
</b></blockquote>


<a name="general"></a>
<p class="nav">
[<a href="#top">back to top: volume</a>]
</p>
<h3 class="usage"><b>General Display Options</b> &nbsp;&nbsp;&nbsp;
(Usage:&nbsp;<a href="#top"><b>volume</b></a>&nbsp;&nbsp;<i>model-spec</i>&nbsp;&nbsp;<i>options</i>)</h3>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <b>show</b>
  <br>Display the volume model.
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/showmap.png"></a>
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <b>hide</b>
  <br>Undisplay the volume model.
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/hidemap.png"></a>
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <b>toggle</b>  
  <br>
  Of the specified volume models,
  show those that are hidden and hide those that are shown.
</blockquote>
<blockquote>
<a href="#top" class="nounder">&bull;</a>
<a name="style"><b>style</b> &nbsp;surface | mesh | image</a>
<br>Designate the style of display:
the <b>surface</b> and <b>mesh</b> modes show isosurfaces (contour surfaces), 
while the <b>image</b> mode (synonym <b>solid</b>) refers to a cloudlike display
with varying intensity and opacity.
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/mapsurf.png"></a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/mesh.png"></a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/mapimage.png"></a>
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="close"><b>close</b></a> &nbsp;surface | image
<br>
Close submodels with display style <b>surface</b>
(including both surface and mesh) or <b>image</b>.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="pickable"><b>pickable</b></a> &nbsp;true | false
<br>
Whether a volume model should be <a href="../selection.html">selectable</a>
with the mouse (initial default <b>true</b>).
This setting can be applied to individual models, but if the model
specification is omitted, the setting is global and applies to all 
volume models, including those opened later within the same session.
</blockquote>
Separate sets of <a href="#level">level</a>, <a href="#color">color</a>,
<a href="#brightness">brightness</a>, and 
<a href="#transparency">transparency</a> information
are maintained for the surface/mesh and image styles of a volume model;
switching to image from surface or mesh (or <i>vice versa</i>) restores 
any previous assignments for that style.
See also: <a href="#dispsurf">surface and mesh display options</a>,
<a href="#dispsolid">image display options</a>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="level"><b>level</b> &nbsp;<i>threshold-level</i></a>&nbsp;
  <br>Place a <b><i>threshold</i></b>
  for mapping data values to the display. Can be given multiple times
  in the same command for multiple contour levels on the same volume data.
  <ul class="circle">
  <li>For <b>surface</b> and <b>mesh</b> displays, <i>threshold-level</i> is 
  a single number, the contour level of the surface.  
  This corresponds to horizontal placement on a histogram in the
  graphical interface.
  To adjust the threshold level automatically so that the contour
  encloses a specified spatial volume,
  see the <a href="#encloseVolume"><b>encloseVolume</b></a>
  and <a href="#fastEncloseVolume"><b>fastEncloseVolume</b></a> options.
<br><br>
  <li>For <b>image</b> displays, <i>threshold-level</i> consists of two numbers 
  separated by a comma (no spaces). The first number indicates a data value
  and the second number indicates an intensity ranging from 0.0 to 1.0.
  These correspond to horizontal and vertical placement, respectively, 
  on a histogram in the graphical interface.
  </ul>
  Threshold levels can be adjusted interactively by dragging in the
  <a href="../tools/volumeviewer.html"><b>Volume Viewer</b></a> histogram
  or by using the <a href="ui.html#mousemode">mouse mode</a> for
  <b>contour level</b>
  <a href="../tools/mousemodes.html" title="Right Mouse Toolbar...">
<img class="icon" border=1 src="../tools/mouse-icons/contour.png"></a>
  or <b>windowing</b> <a href="../tools/mousemodes.html#multiwindowing" 
  title="Right Mouse Toolbar...">
<img class="icon" border=1 src="../tools/mouse-icons/windowing.png"></a>
  in the graphics window.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="rmsLevel"><b>rmsLevel</b> &nbsp;<i>threshold-level</i></a>&nbsp;
  <br>
  <a href="#top" class="nounder">&bull;</a>
  <a name="sdLevel"><b>sdLevel</b> &nbsp;<i>threshold-level</i></a>&nbsp;
  <br>
  Same as <a href="#level"><b>level</b></a>, except with <i>threshold-level</i>
  specified in units of root-mean-square (RMS) deviations from zero
  or standard deviations (SD) from the mean, respectively, 
  calculated for the 
  current <a href="../tools/volumeviewer.html#region">display region</a>
  and <a href="#sampling">step size</a>.
  See also: <a href="#scale"><b>volume scale</b></a>,
<a href="measure.html#mapstats"><b>measure mapstats</b></a>
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="color"></a>
  <b>color</b> &nbsp;<a href="colornames.html"><i>color-spec</i></a>&nbsp;
  <br>Assign <a href="#level">threshold</a> color.
Can be given multiple times in the same command if multiple 
<a href="#level">threshold levels</a> are also specified.
To specify initial colors for maps that have not yet been opened,
see the <a href="#initialColors"><b>initialColors</b></a> option.
</blockquote>
Multiple <a href="#level">level</a> and <a href="#color">color</a>
specifications can be included in a single command.
If one color is specified but no levels, the color applies to all existing 
levels and becomes the default color for the volume model.  
If levels are given but no color, the model's current default color is used 
for the levels, and all old levels are removed. 
If one color and one or more levels are given, that color applies to all 
levels but does not become the default color. Otherwise,
if multiple colors are specified, there must be either be an equal number 
of levels specified in the command, or no level specifications but an
equal number of pre-existing levels.
Levels and colors are paired in the order given,
but they do not need to be interleaved; 
only the ordering of each type of specification (levels or colors)
is significant. If multiple colors are specified for multiple pre-existing
levels, they are paired in order of increasing level value.
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="initialColors"></a>
  <b>initialColors</b> &nbsp;<i>color-list</i>
  <br>
Specify initial colors for subsequently opened maps as a list of
<a href="colornames.html">color specifications</a> separated by commas only.
Applies to the current session only, but can be used with
<a href="#defaultvalues"><b>volume defaultvalues</b></a>
to customize future sessions, for example:
  <blockquote>
 <b>volume defaultvalues initialColors salmon,lime,#ff805c save true</b>
 </blockquote>
The factory defaults are <img src="mapcolors.png">.
See also: <a href="colortables.html#map">initial colors</a>
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="brightness"><b>brightness</b> &nbsp;<i>value</i></a>&nbsp;
  <br>Brightness scales the intensity of the <a href="#color">color</a> 
  (default <b>1.0</b>). A value greater than 1.0 may be used, but the RGB color 
  components multiplied by the value are clamped to the range 0.0&ndash;1.0.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="transparency"><b>transparency</b> &nbsp;<i>value</i></a>&nbsp;
  <br>Transparency values range from 0.0 (fully opaque) 
  to 1.0 (fully transparent).
  <ul class="circle">
  <li>For <b>surface</b> and <b>mesh</b> displays, transparency
  is the fraction of light transmitted from behind the surface or a
  line of mesh (default <b>0.0</b>). By default,
  these objects are dimmed as they are made more transparent
  (see <a href="#dim"><b>dimTransparency</b></a>.) See also:
  <a href="../tools/densitymaps.html" title="Map Toolbar...">
  <img class="icon" border=1 src="../tools/shortcut-icons/icecube.png"></a>
<br><br>
  <li>For <b>image</b> displays, this setting gives the slab thickness 
  (as a fraction of the dataset's shortest dimension, 
  range 0.0&ndash;1.0, default <b>0.5</b>) 
  that gives the transparency indicated by threshold
  height on the histogram (<a href="#soliddetails">details...</a>).
  By default, more transparent voxels are made dimmer
  (see <a href="#dimvox"><b>dimTransparentVoxels</b></a>).
  </ul>
</blockquote>
<blockquote>
<a href="#top" class="nounder">&bull;</a>
<a name="change"></a><b>change</b> &nbsp;surface | image
<br>
The <b>change</b> option is only needed to change settings of a
hidden display style when a volume model has both
<b>surface</b> (surface and/or mesh) and <b>image</b> submodels.
It applies to settings specified with <a href="#level"><b>level</b></a>,
<a href="#rmsLevel"><b>rmsLevel</b></a>,
<a href="#sdLevel"><b>sdLevel</b></a>,
<a href="#color"><b>color</b></a>,
<a href="#brightness"><b>brightness</b></a>,
and <a href="#transparency"><b>transparency</b></a>.
If <b>change</b> is not used,
the setting applies to whichever style is currently shown.
</p>
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="encloseVolume"><b>encloseVolume</b> &nbsp;<i>volume</i></a>
  <br>Automatically set <b>surface</b> or <b>mesh</b>
  <a href="#level">threshold level</a> to enclose
  the specified <i>volume</i> in distance units cubed (<i>e.g.</i>, 
  &Aring;<sup>3</sup> if the grid spacing is expressed in &Aring;). 
  Multiple volume models can be specified in the same command to make their
  isosurfaces enclose the same spatial volume. 
  The level is determined by an iterative procedure. In each iteration,
  the density value midway between the upper and lower bounds is tested.
  If the resulting enclosed volume is larger (smaller) than the target, 
  that midpoint value becomes the new lower (upper) bound.
  In the first iteration, the upper and lower bounds are the maximum
  and minimum values in the map.  Iteration stops when the
  actual enclosed volume differs from the target by less than 
  0.001 of the target or 30 iterations have been performed.
  The <a href="#fastEncloseVolume"><b>fastEncloseVolume</b></a> option
  is similar but uses a noniterative approximation.
  See also: 
  <a href="vseries.html#align"><b>vseries align</b></a>,
<a href="measure.html#volume"><b>measure volume</b></a>
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="fastEncloseVolume"><b>fastEncloseVolume</b> &nbsp;<i>volume</i></a>
  <br>Automatically set <b>surface</b> or <b>mesh</b>
  <a href="#level">threshold level</a> to enclose
  the specified <i>volume</i> in distance units cubed (<i>e.g.</i>, 
  &Aring;<sup>3</sup> if the grid spacing is expressed in &Aring;). 
  Multiple volume models can be specified in the same command to make their
  isosurfaces enclose the same spatial volume.
  The number of grid points to enclose is estimated by dividing the target
  volume by the volume of one grid cell, and then the level corresponding
  to that number of points is estimated by sorting the data values into
  10,000 bins of equal width and identifying the value bin that attains
  (cumulatively) that number of points.
  The <a href="#encloseVolume"><b>encloseVolume</b></a> option
  is similar but uses an iterative procedure with increased accuracy
  at the cost of increased computation time.
  See also: 
  <a href="vseries.html#align"><b>vseries align</b></a>,
<a href="measure.html#volume"><b>measure volume</b></a>
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="outline"><b>showOutlineBox</b> &nbsp;true | <b>false</b></a>
  <br>Outline the bounding box of the 
  current <a href="../tools/volumeviewer.html#region">display region</a>.
  <a href="../tools/densitymaps.html" title="Map Toolbar...">
  <img class="icon" border=1 src="../tools/shortcut-icons/outlinebox.png"></a>
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <b>outlineBoxRgb</b> &nbsp;<a href="colornames.html"><i>color-spec</i></a>
  <br>Assign a color to the <a href="#outline">outline box</a>
  (default <b>white</b>). Any transparency in the color will be ignored.
</blockquote>
<!-- currently not available, ticket #1315
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
 <b>outlineBoxLinewidth</b> &nbsp;<i>width</i>
 <br>Set pixel linewidth of the <a href="#outline">outline box</a>.
 The <i>width</i> must be a positive integer (default <b>1</b>).
</blockquote>
-->
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="calculateSurfaces"></a>
  <b>calculateSurfaces</b> &nbsp;true | <b>false</b>
<br>
Whether to force calculating a volume isosurface immediately rather 
than at the next graphics frame update. 
Setting this option to true in a <b>volume</b> command that modifies
surface geometry (for example, setting the <a href="#level">level</a>)
is needed when another command that would use the surface geometry 
is appended to it with a semicolon separator, 
which indicates no graphics frame update between the commands.
See: <a href="usageconventions#cxc-files">ChimeraX command files</a>
</blockquote>

<a name="sampling"></a>
<p class="nav">
[<a href="#top">back to top: volume</a>]
</p>
<h3 class="usage"><b>Sampling and Size Options</b> &nbsp;&nbsp;&nbsp;
(Usage:&nbsp;<a href="#top"><b>volume</b></a>&nbsp;&nbsp;<i>model-spec</i>&nbsp;&nbsp;<i>options</i>)</h3>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <b>step</b> &nbsp;<i>N</i> | <i>Nx,Ny,Nz</i>
  <br>Step values indicate sampling density; a step of 1 
  means all data points are used to generate the display, 
  while 2 means every other data point is taken along each axis.
  Step sizes must be integers.  If a single number is supplied, it is
  used in all three directions; if three numbers are supplied
  (separated by commas but not spaces), they
  are used in the X, Y, and Z directions, respectively.
  Changing a step value will change the data size limit for automatic 
  step adjustment (see <a href="#voxmax"><b>voxelLimit</b></a>).
See also:
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/step1.png"></a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/step2.png"></a>
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="autostep"><b>limitVoxelCount</b> &nbsp;<b>true</b> | false</a>
  <br>Automatically adjust <a href="#sampling">step size</a> so that no more
  than the <a href="#voxmax">specified voxel limit</a> is displayed.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="voxmax"><b>voxelLimit</b> &nbsp;<i>limit</i></a>
  <br>Set the maximum number of Mvoxels to be displayed (default <b>1.0</b>)
  when <a href="#autostep"><b>limitVoxelCount</b></a> is set to true.
</blockquote>
The remaining options in this section are global and apply to all volume models, 
regardless of which are specified:
<!-- but are not (yet) saved in preferences -->
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="dispopen"><b>showOnOpen</b> &nbsp;<b>true</b> | false</a>
  <br>Automatically display a data set when it is opened if it does not
  exceed a <a href="#dispsize">specified size</a>.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="dispsize"><b>voxelLimitForOpen</b> &nbsp;<i>size</i></a> 
  <br>Set the data size limit in Mvoxels below which data should be
  automatically displayed when opened (default <b>256.0</b>) when
  <a href="#dispopen"><b>showOnOpen</b></a> is set to true.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="dispplane"><b>showPlane</b> &nbsp;<b>true</b> | false</a>
  <br>Initially display just a single plane (normal to the Z axis) 
  of a data set if it exceeds a <a href="#planesize">specified size</a>.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="planesize"><b>voxelLimitForPlane</b> &nbsp;<i>size</i></a>
  <br>Set the data size limit in Mvoxels above which a single plane of
  the data should be initially displayed (default <b>256.0</b>) when
  <a href="#dispplane"><b>showPlane</b></a> is set to true.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <b>dataCacheSize</b> &nbsp;<i>size</i>
  <br>Set how much memory in Mb should be dedicated to volume data 
  (default is half the physical memory in the computer). 
  A cache can improve performance, since accessing 
  cached data is faster than reading it from disk. 
  The least recently displayed data values are purged to maintain the specified
  <i>size</i>. The data cache only accounts for approximately 1/3 to 1/2
  of the memory used in viewing volume data, as additional memory is 
  occupied by surfaces and color arrays.
</blockquote>

<a name="dimensions"></a>
<p class="nav">
[<a href="#top">back to top: volume</a>]
</p>
<h3 class="usage"><b>Dimension and Scale Options</b> &nbsp;&nbsp;&nbsp;
(Usage:&nbsp;<a href="#top"><b>volume</b></a>&nbsp;&nbsp;<i>model-spec</i>&nbsp;&nbsp;<i>options</i>)</h3>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <b>region</b> &nbsp;all | <i>i1,j1,k1,i2,j2,k2</i>
  <br>Show the full data set (specified with <b>all</b>)
  or the data region with grid indices 
  <i>i1&ndash;i2</i> along the X axis,
  <i>j1&ndash;j2</i> along the Y axis, and
  <i>k1&ndash;k2</i> along the Z axis.  
  Grid indices must be integers separated by commas but not spaces.
  Grid indices start at zero.
See also:
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/fullvolume.png"></a>,
the <b>crop volume</b> <a href="ui.html#mousemode">mouse mode</a>
<a href="../tools/mousemodes.html" title="Right Mouse Toolbar...">
<img class="icon" border=1 src="../tools/mouse-icons/crop.png"></a>
</blockquote>
<!-- not supported
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="name"><b>nameRegion</b> &nbsp;<i>name</i></a>
  <br>Assign <i>name</i> to the currently displayed region.
</blockquote>
-->
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="origin"><b>origin</b> &nbsp;<i>x,y,z</i></a>
  <br>Place the grid origin at coordinates <i>x,y,z</i> (numbers separated
  by commas but not spaces).
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="originIndex"><b>originIndex</b> &nbsp;<i>i,j,k</i></a>
  <br>Place the coordinate origin (0,0,0)
   at grid indices <i>i,j,k</i> (numbers separated by commas but not spaces).
   Fractional and negative values are allowed, as the origin is not 
   required to coincide with a grid point or even to fall within the grid.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <b>voxelSize</b> &nbsp;<i>S</i> | <i>Sx,Sy,Sz</i>
  <br>Voxel size indicates the scale of the data set, the spacing of
  points in units of distance.  If a single number is supplied, it is
  used in all three directions; if three numbers are supplied 
  (separated by commas but not spaces), they
  are used in the X, Y, and Z directions, respectively.
  The grid is anchored at the coordinate origin 
  (<a href="#originIndex"><b>originIndex</b></a> remains unchanged).
</blockquote>

<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="symmetry"><b>symmetry</b> &nbsp;<i>sym-type</i></a>
  <br>Assign the specified symmetry to the volume data set.
  This information is retained in files <a href="save.html">saved</a> 
  in <a href="save.html#chimap">Chimera map</a> format and can be used by 
  other commands such as <a href="molmap.html"><b>molmap</b></a>,
  <a href="sym.html"><b>sym</b></a>,
  and <a href="fitmap.html"><b>fitmap</b></a>.
  For automatic symmetry detection and assignment, see the command 
  <a href="measure.html#symmetry"><b>measure symmetry</b></a>.
  Most <i>sym-type</i> options have additional sub-options or parameters:
  <ul>
  <li>symmetry of model <b>#<i>N</i></b>
  &ndash; use &ldquo;biological assembly&rdquo; information from an atomic
  model (currently only read from PDB format, not mmCIF)
  or the symmetry assignment of another volume model
    <ul type="none">
    <li>Example: <b>#4</b>
    </ul>

  <li>cage model (from <b>Cage Builder</b>) polygon symmetry
  <b>#<i>N</i>,p<i>M</i></b> or <b>#<i>N</i>,pn<i>M</i></b>
  &ndash; place copies at equivalent positions relative to each M-sided polygon
  in the cage model with ID number <b>N</b>. The <b>p<i>M</i></b> form places
  one copy per M-sided polygon, whereas <b>pn<i>M</i></b> places M copies per
  M-sided polygon using C<font size=-1><i>M</i></font> symmetry about the center
  of the M-sided polygon nearest the original copy.
    <ul type="none">
    <li>Examples: <b>#2,p6</b> or <b>#2,pn5</b>
    </ul>

 <li>cyclic symmetry <b>C<i>n</i></b>
   around <a href="#axis">axis</a> and <a href="#center">center</a>
    <ul type="none">
    <li>Example: <b>C3</b>
    </ul>

  <li>dihedral symmetry <b>D<i>n</i></b>
   around <a href="#axis">axis</a> and <a href="#center">center</a>
    <ul type="none">
    <li>Example: <b>d7</b>
    </ul>

  <li>tetrahedral symmetry <b>T[,<i>orientation</i>]</b>
   around <a href="#center">center</a>
    <ul type="none">
    <li>Example: <b>t,z3</b>
    </ul>
   where <i>orientation</i> can be:
   <ul>
   <li><b>222</b> (default)
   &ndash; with two-fold symmetry axes along the X, Y, and Z axes, a three-fold
    along axis (1,1,1)
   <li><b>z3</b> &ndash; a three-fold symmetry axis along Z, another three-fold
   axis in the YZ plane such that rotation about the X axis by ~110&deg; is a
   symmetry operation (EMAN convention)
   </ul>

  <li>octahedral symmetry <b>O</b> around <a href="#center">center</a>

  <li>icosahedral symmetry <b>I[,<i>orientation</i>]</b>
   around <a href="#center">center</a>
    <ul type="none">
    <li>Example: <b>i,n25</b>
    </ul>
   where <i>orientation</i> can be:
    <ul>
    <li><b>222</b> (default)
    &ndash; with two-fold symmetry axes along the X, Y, and Z axes
    <li><b>2n5</b> &ndash; with two-fold symmetry along X and 5-fold along Z
    <li><b>n25</b> &ndash; with two-fold symmetry along Y and 5-fold along Z
    <li><b>2n3</b> &ndash; with two-fold symmetry along X and 3-fold along Z
    <li><b>222r</b> &ndash; same as 222 except rotated 90&deg; about Z
    <li><b>2n5r</b> &ndash; same as 2n5 except rotated 180&deg; about Y
    <li><b>n25r</b> &ndash; same as n25 except rotated 180&deg; about X
    <li><b>2n3r</b> &ndash; same as 2n3 except rotated 180&deg; about Y
    </ul>

  <li>helical symmetry
  <b>H,<i>rise,angle,n</i>[,<i>offset</i>]</b>
  around <a href="#axis">axis</a> and <a href="#center">center</a>
    <ul type="none">
    <li>Example: <b>h,43.5,21,6,-2</b>
    </ul>
  where <i>rise</i> is the translation along the <a href="#axis">axis</a> per
  subunit, <i>angle</i> is the rotation in degrees per subunit,
  and <i>n</i> is how many copies total (including the original)
  the resulting segment of infinite helix should contain.
  The integer <i>offset</i> (default <b>0</b>) allows extending the helix in
  both directions.  The example above would give <i>n</i> = 6 copies total,
  with two copies in the negative axis direction,
  one at the identity position, and three in the positive axis direction.

  <li>translational symmetry
  <b>shift,<i>n,distance</i></b> along <a href="#axis">axis</a>
  &ndash; or &ndash; <b>shift,<i>n,x,y,z</i></b>
    <ul type="none">
    <li>Example: <b>shift,3,26.7</b>
    </ul>
  where <i>n</i> is how many copies total (including the original)
  the result should contain.
  The translation can be expressed as a
  <i>distance</i> along the <a href="#axis">axis</a>
  or as a vector <i>x,y,z</i> in the
  <a href="#coordinateSystem">reference coordinate system</a>.

  <li>the product of symmetry groups, each specified as described above
  and separated by <b>*</b> to indicate multiplying each symmetry matrix of one
  group with each symmetry matrix of another; can be generalized to
  multiple symmetry groups (not just two)
    <ul type="none">
    <li>Example: <b>c2*h,42,21,9,-4</b>
    </ul>
  </ul>
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="axis"></a><b>axis</b>
  &nbsp;<a href="pointspec.html#vector"><i>vector-spec</i></a>
  <br>
  Specify axis of symmetry 
  <a href="pointspec.html#vector">vector</a> (default <b>z</b>).
  </ul>
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="center"></a><b>center</b> 
  &nbsp;<a href="pointspec.html#point"><i>point-spec</i></a>
  <br>
  Specify center of symmetry
  <a href="pointspec.html#point">point</a> in physical coordinates
  (default <b>0,0,0</b>).
  This option is overridden by <a href="#centerIndex"><b>centerIndex</b></a>.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="centerIndex"><b>centerIndex</b>
  [&nbsp;<i>i</i>&nbsp;|&nbsp;<i>i,j,k</i>&nbsp;]</a>
  <br>
  Specify center of symmetry in grid coordinates, given as a single 
  value or three values separated by commas only.
  Grid indices start at zero.
  Fractional and negative values can be used.  If a single value is given, 
  it is used as the grid coordinate along all three axes.
  This option overrides <a href="#center"><b>center</b></a>.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="coordinateSystem"></a><b>coordinateSystem</b> 
  &nbsp;<a href="atomspec.html#hierarchy"><i>model-spec</i></a>
  <br>
  Specify a reference coordinate system for interpreting specifications of
  <a href="#axis">axis</a> and <a href="#center">center</a> of symmetry.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="dump"><b>dumpHeader</b> &nbsp;true | <b>false</b></a>
  <br>Whether to write the file header contents (if any) of a map read from 
  MRC or CCP4 format to the <a href="../tools/log.html"><b>Log</b></a>.
</blockquote>

<a name="planes"></a>
<p class="nav">
[<a href="#top">back to top: volume</a>]
</p>
<h3 class="usage"><b>Planes Options</b> &nbsp;&nbsp;&nbsp;
(Usage:&nbsp;<a href="#top"><b>volume</b></a>&nbsp;&nbsp;<i>model-spec</i>&nbsp;&nbsp;<i>options</i>)</h3>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <b>planes</b> &nbsp;<i>axis</i>[,<i>start</i>[,<i>end</i>[,<i>increment</i>[,<i>depth</i>]]]]
  <br>Sequentially display slabs <i>depth</i> planes thick along the
  specified data <i>axis</i> (<b>x</b>,<b>y</b>, or <b>z</b>) starting from
  index <i>start</i> and repositioning the slab by <i>increment</i> 
  grid units per frame until the index at the next frame would 
  exceed <i>end</i>. 
  The indices refer to the first displayed plane along the axis.
  If only the axis is given, a single plane at the center of the 
  current <a href="../tools/volumeviewer.html#region">display region</a>
  will be shown.
  If no <i>end</i> is supplied, only a single slab will be shown.  
  The default <i>increment</i> and <i>depth</i> are both <b>1</b>.
  Only planes that are multiples of the <a href="#sampling">step size</a>
  will be shown, and the <i>depth</i> refers to the number of planes
  shown rather than a grid index range.
  Although an <i>increment</i> smaller than the step size can be specified, 
  at each frame the grid index will be rounded down to a 
  multiple of the step size, resulting in the same plane being displayed in
  more than one frame.  To avoid this, change the step size to 1 beforehand
  or specify <i>start</i>, <i>end</i> and <i>increment</i> values
  consistent with the current step size. The <i>start</i>, <i>end</i>,
  <i>increment</i>, and <i>depth</i> parameters can be floating-point numbers.
  For example, an <i>increment</i> of 0.25 with step size 1 will show each
  plane for 4 frames.
  See also: 
<a href="topography.html"><b>topography</b></a>,
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/plane.png"></a>,
  the <b>move planes</b> <a href="ui.html#mousemode">mouse mode</a>
<a href="../tools/mousemodes.html" title="Right Mouse Toolbar...">
<img class="icon" border=1 src="../tools/mouse-icons/moveplanes.png"></a>,
<a href="#tile"><b>volume tile</b></a>
<p>
Pausing the cursor over a single-plane display shows the voxel indices 
and data value in a pop-up balloon.
</p>
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="expandSinglePlane"><b>expandSinglePlane</b>&nbsp;&nbsp;true&nbsp;|&nbsp;false</a>
  <br>
  Expand a single-plane display
  along its perpendicular axis to the full thickness of the data.
  This option does not apply to <a href="#orthoplanes">orthogonal planes</a>.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="orthoplanes"><b>orthoplanes</b></a>
  &nbsp;xyz&nbsp;|&nbsp;xy&nbsp;|&nbsp;yz&nbsp;|&nbsp;xz&nbsp;|&nbsp;off
  [&nbsp;<b>positionPlanes</b>&nbsp;&nbsp;<i>i,j,k</i>&nbsp;]
  <br>Display planes perpendicular to the X, Y, and/or Z data axes within the
  current <a href="../tools/volumeviewer.html#region">display region</a>.
  If only a single plane is shown beforehand, it will be
  <a href="#expandSinglePlane">expanded</a> to define the region.
  The <b>positionPlanes</b> option specifies plane locations along the axes 
  by integer grid indices (default <b>0,0,0</b> or the lowest indices in the
  current <a href="../tools/volumeviewer.html#region">display region</a>).
  Orthogonal planes automatically use the 
  <b>image</b> <a href="#style">display style</a>,
  opaque <a href="#dispsolid">color mode</a>, 
  and an <a href="#outline">outline</a>, 
  although these can be overriden with the corresponding command options. 
  Turning orthogonal planes <b>off</b> restores the <b>auto8</b>
  <a href="#dispsolid">color mode</a>.
  See also:
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/orthoplanes.png"></a>,
  the <b>move planes</b> <a href="ui.html#mousemode">mouse mode</a>
<a href="../tools/mousemodes.html" title="Right Mouse Toolbar...">
<img class="icon" border=1 src="../tools/mouse-icons/moveplanes.png"></a>
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="boxfaces"><b>boxFaces</b>&nbsp;&nbsp;true&nbsp;|&nbsp;false</a>
  <br>Show data values on the six box faces of the
  current <a href="../tools/volumeviewer.html#region">display region</a>.
  If only a single plane is shown beforehand, it will be
  <a href="#expandSinglePlane">expanded</a> to define the region.
  Box-face planes automatically use the
  <b>image</b> <a href="#style">display style</a>,
  opaque <a href="#dispsolid">color mode</a>,   
  and an <a href="#outline">outline</a>,
  although these can be overriden with the corresponding command options.
  Turning box-face planes <b>off</b> restores the <b>auto8</b>
  <a href="#dispsolid">color mode</a>.
</blockquote>

<a name="dispsurf"></a>
<p class="nav">
[<a href="#top">back to top: volume</a>]
</p>
<h3 class="usage"><b>Surface and Mesh Display Options</b> &nbsp;&nbsp;&nbsp;
(Usage:&nbsp;<a href="#top"><b>volume</b></a>&nbsp;&nbsp;<i>model-spec</i>&nbsp;&nbsp;<i>options</i>)</h3>
<p>
The <b>surface</b> and <b>mesh</b> <a href="#style">display styles</a>
both depict isosurfaces.
</p>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="smoothing"><b>surfaceSmoothing</b> &nbsp;true | <b>false</b></a>
  <br>Whether to smooth surface and mesh displays.
  Smoothing entails moving each vertex
  a <a href="#smoothfact">specified fraction</a> 
  of the way toward the average position of its neighbors
  a <a href="#smoothiter">specified number</a> of times.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="smoothiter"><b>smoothingIterations</b> &nbsp;<i>N</i></a>
  <br>How many iterations of smoothing to perform (default <b>2</b>)
  when <a href="#smoothing"><b>surfaceSmoothing</b></a> is set to true.
  Each vertex is moved once per iteration.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="smoothfact"><b>smoothingFactor</b> &nbsp;<i>f</i></a>
  <br>How far to move each vertex 
  when <a href="#smoothing"><b>surfaceSmoothing</b></a> is set to true.
  In each <a href="#smoothiter">iteration</a>, each vertex
  is moved a fraction <b><i>f</i></b> (ranging from 0.0 to 1.0,
  default <b>0.3</b>) of the way toward the average position of the vertices
  connected to it by triangle edges.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="subdivide"><b>subdivideSurface</b> &nbsp;true | <b>false</b></a>
  <br>Whether to subdivide each triangle in surface and mesh displays
  into four smaller triangles a
  <a href="#sublevels">specified number</a> of times.
  A triangle is subdivided by connecting the midpoints of its edges.
  Subdivision can help to produce smoother surfaces 
  when combined with the <a href="#smoothing"><b>surfaceSmoothing</b></a> 
  option.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="sublevels"><b>subdivisionLevels</b> &nbsp;<i>j</i></a>
  <br>How many times to subdivide triangles when
  <a href="#subdivide"><b>subdivideSurface</b></a> is set to true.
  The number of triangles is increased by a factor of 
  4<sup><i>j</i></sup>, where <i>j</i> is a positive integer
  (default <b>1</b>).
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <b>smoothLines</b> &nbsp;true | <b>false</b>
  <br>Turn on anti-aliasing to smooth lines in mesh displays.
  Mesh lines with <a href="#transparency">transparency</a> &gt; 0.0 can 
  only be smoothed when <a href="#dim"><b>dimTransparency</b></a> is true.
  A side effect of OpenGL anti-aliasing is that dense meshes 
 look brighter from some viewpoints and darker from others, depending on the
  order in which the lines were drawn.  
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <b>squareMesh</b> &nbsp;<b>true</b> | false
  <br>Display only a subset of the lines in the triangular mesh.  
  Lines in the square mesh show the intersection of the 
  XY, YZ, and XZ grid planes with the contour surface.
</blockquote>
<!-- currently not available, ticket #1315
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
 <b>lineThickness</b> &nbsp;<i>width</i>
 <br>Set pixel linewidth used in mesh displays. The <i>width</i>
 must be a positive integer (default <b>1</b>).
</blockquote>
-->
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="dim"><b>dimTransparency</b> &nbsp;<b>true</b> | false</a>
  <br>Decrease the brightness of surface and mesh displays as their
  <a href="#transparency">transparency</a> is increased.
  When dimming is on, OpenGL (alpha,1&ndash;alpha)
  blending is used instead of (1,1&ndash;alpha) blending.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="meshLighting"><b>meshLighting</b> &nbsp;<b>true</b> | false</a>
  <br>Make the inside of a mesh-enclosed volume dimmer than the outside
  by varying the brightness according to the angle
  between each surface point normal and the line of sight.
  Brightness is maximal when the outward-facing normal
  is parallel to the line of sight and pointing at the user
  (see more on the definition of &ldquo;outward&rdquo; under 
  <a href="#flipNormals"><b>flipNormals</b></a>).
  When this option is off, the brightness does not vary with
  the angle between the normal and the line of sight.
See also: <a href="material.html"><b>material</b></a>
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="two-sided"><b>twoSidedLighting</b> &nbsp;<b>true</b> | false</a>
  <br>Light both sides of surface displays.
  Otherwise, only the outside of a surface-enclosed volume will be lit
  (see more on the definition of &ldquo;outside&rdquo; under 
  <a href="#flipNormals"><b>flipNormals</b></a>).
  The brightness of each lit side varies according to the angle between a
  surface point normal and the line of sight;
  brightness is maximal when the normal is parallel to the line of sight.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="flipNormals"><b>flipNormals</b> &nbsp;<b>true</b> | false</a>
  <br>Affects surface displays when 
  <a href="#two-sided"><b>twoSidedLighting</b></a> is set to false,
  mesh displays when
 <a href="#meshLighting"><b>meshLighting</b></a> is set to true.
  When <b>flipNormals</b> is true,
  the side toward larger or more positive values is treated
  as the outside for negative <a href="#level">thresholds</a>
  and the side toward smaller or more negative values is treated 
  as the outside for positive <a href="#level">thresholds</a>
  (appropriate for data in which the sign is meaningful, 
  such as <a href="open.html#local">electrostatic potential</a>).
  When <b>flipNormals</b> is false,
  the side toward smaller or more negative data
  values is always treated as the outside.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="capFaces"><b>capFaces</b> &nbsp;<b>true</b> | false</a>
  <br>Cover the faces of the volume data box where high values would be exposed.
</blockquote>

<a name="dispsolid"></a>
<p class="nav">
[<a href="#top">back to top: volume</a>]
</p>
<h3 class="usage"><b>Image Display Options</b> &nbsp;&nbsp;&nbsp;
(Usage:&nbsp;<a href="#top"><b>volume</b></a>&nbsp;&nbsp;<i>model-spec</i>&nbsp;&nbsp;<i>options</i>)</h3>
<p>
  The <b>image</b> <a href="#style">display style</a>
  shows data as a semitransparent solid.
  The following options apply to this style.
</p>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="imageMode"></a>
  <b>imageMode</b> &nbsp;<i>mode</i> 
<br>
The <i>mode</i> can be any of the following:
<ul>
<li><b>orthoplanes</b> &ndash; <a href="#orthoplanes">orthoplanes</a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/orthoplanes.png"></a>
<li><b>box faces</b> &ndash; <a href="#boxfaces">box faces</a> of the 
current <a href="../tools/volumeviewer.html#region">display region</a>
<li><a name="tiltedslab"><b>tilted slab</b></a>
&ndash; a slab of the data 
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/slab.png"></a>
at any angle relative to the data axes
(can also be enabled with <b>tiltedSlab true</b>), with additional options:
  <ul>
  <li><b>tiltedSlabAxis</b> 
  &nbsp;<a href="pointspec.html#vector"><i>vector-spec</i></a> &ndash;
  slab orientation expressed as a vector perpendicular to the slab
  <li><b>tiltedSlabOffset</b> <i>d</i> &ndash; position along the axis,
where <i>d</i> is the inner product of the vector <i>p</i> (a point on the slab)
and the axis vector: <i>d</i> = (<i>p</i>,<i>axis</i>) 
  <li><b>tiltedSlabPlaneCount</b> <i>N</i> &ndash; 
  slab thickness in number of planes
  <li><b>tiltedSlabSpacing</b> <i>s</i> &ndash; plane spacing in &Aring;
  </ul>
<li><b>full region</b> &ndash; return to showing the full contents of the 
current <a href="../tools/volumeviewer.html#region">display region</a>
after showing orthoplanes, box faces, or a tilted slab
</ul>
Typically, the graphical interface would be used rather than commands:
<a href="../tools/densitymaps.html"><b>Map</b></a> icons or
the <a href="../tools/volumeviewer.html"><b>Volume Viewer</b></a> 
display-style menu would be used to switch the image mode, and in
the <b>tilted slab</b> mode, slab orientation would be adjusted with the
<b>rotate slab</b> <a href="ui.html#mousemode">mouse mode</a>
<a href="../tools/mousemodes.html#rotateslab" title="Right Mouse Toolbar...">
<img class="icon" border=1 src="../tools/mouse-icons/rotateslab.png"></a>,
slab offset with either the <b>rotate slab</b> button + <b>Shift</b> or the
<b>move planes</b> <a href="ui.html#mousemode">mouse mode</a>
<a href="../tools/mousemodes.html" title="Right Mouse Toolbar...">
<img class="icon" border=1 src="../tools/mouse-icons/moveplanes.png"></a>,
and slab thickness with the 
<b>crop volume</b> <a href="ui.html#mousemode">mouse mode</a>
<a href="../tools/mousemodes.html" title="Right Mouse Toolbar...">
<img class="icon" border=1 src="../tools/mouse-icons/crop.png"></a>.
In <a href="../vr.html">virtual reality</a>, the <b>rotate slab</b> mode
<a href="../tools/mousemodes.html#rotateslab" title="Right Mouse Toolbar...">
<img class="icon" border=1 src="../tools/mouse-icons/rotateslab.png"></a>
can both rotate the tilted slab and translate it along its axis.
The initial tilted slab is perpendicular to the line of sight, 
with center at the center of the
current <a href="../tools/volumeviewer.html#region">display region</a>,
thickness set to 1/5 of the planes in the
current <a href="../tools/volumeviewer.html#region">display region</a>
along X, Y, or Z (whichever is least),
and spacing equal to the smallest of the X, Y, or Z spacing of the data grid.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="backingColor"></a>
  <b>backingColor</b> &nbsp;<a href="colornames.html"><i>color-spec</i></a>&nbsp;
  <br>
Specify a backing color (default <b>none</b>) for rendering when the
<a href="#imageMode">image mode</a> is <b>full region</b> or <b>tilted slab</b>.
A dark backing color such as <b>black</b> may improve data visibility
when the <a href="set.html#bgColor">background color</a>
is white or some other light color.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="cmode"></a>
  <b>colorMode</b> &nbsp;<i>cmode</i>
  <br>Specify color pixel format (OpenGL texture format).
  Possible values of <i>cmode</i> combine 
  a string describing the types of information:
  <ul class="circle">
  <li><b>rgba</b> &ndash; multiple colors and transparency
  <li><b>rgb</b> &ndash; multiple colors, opaque
  <li><b>la</b> &ndash; luminance (single color) and transparency
  <li><b>l</b> &ndash; luminance (single color), opaque
  <li><b>auto</b> &ndash; set the mode based on the current display
  </ul>
  ... with a number of bits: <b>4</b>, <b>8</b>, <b>12</b>, <b>16</b>.
  For example, the default <i>cmode</i> is <b>auto8</b>. 
  See also: <a href="graphics.html#quality"><b>graphics quality</b></a>
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="pmode"></a>
  <b>projectionMode</b> &nbsp;<i>pmode</i>
  <br>Specify projection mode for memory-efficient display of 
  large data sets such as tomograms.  Possible values of <i>pmode</i>:
  <ul class="circle">
  <li><b>auto</b> 
(default except for <a href="../dicom/dicom.html">DICOM</a> )
  <li><b>2d-x</b>
  <li><b>2d-y</b>
  <li><b>2d-z</b>
  <li><b>2d-xyz</b>
  <li><b>3d</b>
(default for <a href="../dicom/dicom.html">DICOM</a> )
  </ul>
  Displaying just the planes perpendicular to one data axis 
  (2d-x, 2d-y, or 2d-z) uses less memory than automatically switching
  to those along the data axis most perpendicular to the screen at a given 
  time (2d-xyz). The auto setting uses 2d-z for volumes with a high aspect
  ratio (second-longest box dimension at least 4 times the shortest box
  dimension), otherwise 3d.
  The 3d mode avoids jumps in brightness during rotation by continuously 
  generating planes perpendicular to the line of sight, spaced
  according to the <a href="#planeSpacing"><b>planeSpacing</b></a> option.
See also:
<a href="../tools/medicalimage.html" title="Medical Image Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/xyzslice.png"></a>
<a href="../tools/medicalimage.html" title="Medical Image Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/perpslice.png"></a>
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="planeSpacing"></a>
  <b>planeSpacing</b> &nbsp;<i>spacing</i>
  <br>
What <i>spacing</i> to use with <a href="#pmode"><b>projectionMode 3d</b></a>,
with possible values:
  <ul class="circle">
  <li><b>min</b> (default) &ndash; smallest spacing of the data along X, Y, or Z
  <li><b>max</b> &ndash; largest spacing of the data along X, Y, or Z
  <li><b>mean</b> &ndash; mean of the data spacing along X, Y, and Z
  <li><i>d</i> &ndash; a specific distance in physical units of length
  </ul>
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="dimvox"><b>dimTransparentVoxels</b> &nbsp;<b>true</b> | false</a>
<br>
If <b>true</b> (default),
scale voxel brightness in image displays by a factor of (1&ndash;transparency).
If <b>false</b>, increasing the <a href="#transparency">transparency</a>
makes a volume appear brighter because less light is blocked.
The <a href="#appearance"><b>appearance</b></a> option also adjusts this setting.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="colormapExtendRight"></a>
  <b>colormapExtendRight</b> &nbsp;<b>true</b>&nbsp;|&nbsp;false
  <br>
The thresholds and connecting lines on each histogram define a 
<a href="#transferfunction">transfer function</a>
that maps data values to colors and intensities.
This option specifies whether the function should be extended horizontally
from the rightmost threshold to the maximum data value
at the far right of the histogram (default <b>true</b>).
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="colormapExtendLeft"></a>
  <b>colormapExtendLeft</b> &nbsp;true&nbsp;|&nbsp;<b>false</b>
  <br>
The thresholds and connecting lines on each histogram define a 
<a href="#transferfunction">transfer function</a>
that maps data values to colors and intensities.
This option specifies whether the function should be extended horizontally
from the leftmost threshold to the minimum data value
at the far left of the histogram (default <b>false</b>).
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="colormapOnGpu"></a>
  <b>colormapOnGpu</b> &nbsp;true&nbsp;|&nbsp;false
<br>
Whether the mapping of volume data values to colors
should be done on the GPU (if true) or CPU (if false).
The default is true for <a href="../dicom/dicom.html">DICOM</a>,
otherwise false.
Colormapping with the GPU is faster but done every time the scene is drawn,
whereas colormapping with the CPU is only done when the colors change.
Colormapping with the GPU may also give a better, less noisy appearance because
the data values rather than the resulting color values are interpolated.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="colormapSize"></a>
  <b>colormapSize</b> &nbsp;<i>N</i>
<br>
Specify the size of the color lookup table (default <b>2048</b>) for 
colormapping on the GPU (any data type) or on the CPU with floating-point data. 
For color mapping on the CPU with 8-bit or 16-bit map data, this value 
is ignored and sizes 256 and 65536 are used instead
so that each data value has its own color.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="fullRegionOnGpu"></a>
  <b>fullRegionOnGpu</b> &nbsp;true&nbsp;|&nbsp;false
<br>
Whether to keep the data
(or colors, if <a href="#colormapOnGpu"><b>colormapOnGpu</b></a> is false)
for the full volume region on the GPU to allow fast cropping.
The default is true for <a href="../dicom/dicom.html">DICOM</a>,
otherwise false.
It is best to use this option with 
<a href="#colormapOnGpu"><b>colormapOnGpu</b></a> true;
otherwise, updating colors for the full region even when only a smaller region 
is shown may slow performance significantly.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="blendOnGpu"></a>
  <b>blendOnGpu</b> &nbsp;true&nbsp;|&nbsp;<b>false</b>
<br>
Whether image-display color blending of
<a href="../tools/volumeviewer.html#multichannel">multichannel data</a>
should be done on the GPU (if true) or CPU (if <b>false</b>; default).
Color blending on the GPU is about an order of magnitude faster.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="maximumintensity">
  <b>maximumIntensityProjection</b> &nbsp;true | <b>false</b></a>
  <br>At each pixel, display the the most intense color value 
  underlying the pixel along the line of sight.
  The maximum intensities of the red, green, and blue color components are
  determined separately, and transparency is ignored.
  This option can be useful for enhancing detail. Unphysical effects
  can result, but are usually not very noticeable; examples include
  the disappearance of a dim spot when it passes in front of a brighter spot
  and the simulation of a single spot when the maximal values of different
  color components under the same pixel actually come from different spots.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="btcorr"></a>
  <b>btCorrection</b> &nbsp;true | <b>false</b>
  <br>Correct brightness and transparency for the viewing angle.
  Without this correction, the apparent brightness and transparency
  of image displays (in <a href="#pmode">projection modes</a> other than 3d)
  will depend on the viewing angle relative to the data axes.  
  For a cube-shaped volume with equal resolution in the X, Y, and Z dimensions,
  the brightness drops and the transparency increases by a factor of
  3<sup>1/2</sup> (approximately 1.7)  as the viewing angle is changed
  from along any axis to along the cube diagonal.
  The brightness correction remedies this, but doubles rendering time.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <b>minimalTextureMemory</b> &nbsp;true | <b>false</b>
  <br>Reuse a single 2D texture for image displays 
  (in <a href="#pmode">projection modes</a> other than 3d)
  instead of allocating
  separate textures for every plane of the data.  This is useful
  for viewing large data sets that would otherwise fail to display,
  but can degrade interactive response.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <b>linearInterpolation</b> &nbsp;<b>true</b> | false
  <br>Linearly interpolate brightness and transparency
  between voxels in image displays.
  Turning interpolation off may yield a pixelated appearance
  but speed up rendering, depending on the graphics hardware.
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="appearance"></a>
  <b>appearance</b> &nbsp;<i>preset-name</i>
<br>
Apply an image appearance <a href="#nameAppearance">preset</a>,
a previously defined collection of display settings 
for maps in the <b>image</b> <a href="#style">display style</a>.
The <i>preset-name</i> should be enclosed in quotation marks 
if it contains any spaces. See also:
<a href="../dicom-quickref.html">ChimeraX DICOM Reference</a>
<p>
Available presets include:
</p>
<ul>
<li><i>approximate</i> implementations of settings from the
<a href="https://horosproject.org/about/" target="_blank">Horos</a> 
and <a href="https://www.mccauslandcenter.sc.edu/mricrogl/home"
target="_blank">MRIcroGL</a> programs for medical image visualization 
and analysis:
<ul>
  <li><a href="https://horosproject.org/about/" target="_blank">Horos</a> 
  &ldquo;3D presets&rdquo; as listed on 
<a href="https://github.com/horosproject/horos/tree/horos/Horos/Resources/3DPRESETS" target="_blank">github</a> 
  (with <a href="#dimvox"><b>dimTransparentVoxels</b></a> false);
  these are generally intended for rendering thicker slabs rather than 
  <a href="#planes">single planes</a>
<br><br>
  <li><a href="https://www.mccauslandcenter.sc.edu/mricrogl/home"
  target="_blank">MRIcroGL</a> color lookup tables (CLUTs):
  <b>CT_Bones</b>, <b>CT_Kidneys</b>, <b>CT_Liver</b>, <b>CT_Lungs</b>, 
  <b>CT_Muscles</b>, <b>CT_Skin</b>, <b>CT_Soft_Tissue</b>, <b>CT_Vessels</b>,
  and <b>CT_w_Contrast</b>
  (with <a href="#dimvox"><b>dimTransparentVoxels</b></a> true
  and <a href="#transparency"><b>transparency</b></a> 0.05)
  </ul>
<br>
<li>ChimeraX built-in presets, also available <i>via</i>
<a href="../tools/medicalimage.html"><b>Medical Image</b></a> icons:
  <ul class="none">
  <li>
  <a href="../tools/medicalimage.html" title="Medical Image Toolbar...">
  <img class="icon" border=1 src="../tools/shortcut-icons/airways.png"></a>
  &nbsp;<b>airways</b>
  &ndash; blue airways
  <li>
  <a href="../tools/medicalimage.html" title="Medical Image Toolbar...">
  <img class="icon" border=1 src="../tools/shortcut-icons/chest.png"></a>
  &nbsp;<b>chest</b>
  &ndash; yellow bones, blue airways, some other tissues in pink
  <li>
  <a href="../tools/medicalimage.html" title="Medical Image Toolbar...">
  <img class="icon" border=1 src="../tools/shortcut-icons/brain.png"></a>
  &nbsp;<b>brain</b>
  &ndash; yellow for fat and similar soft tissue, white of increasing intensity 
  for brain on up to bone, blue for compact bone
  <li>
  <a href="../tools/medicalimage.html" title="Medical Image Toolbar...">
  <img class="icon" border=1 src="../tools/shortcut-icons/initialcurve.png"></a>
  &nbsp;<b>initial</b>
  &ndash; (re)set to the <a href="#level">threshold levels</a> and colors
  chosen automatically for the data when first shown as image, with
  <a href="#dimvox"><b>dimTransparentVoxels</b></a> true, generally useful
  for <a href="#planes">planes</a> or thin slabs.
  <a href="../dicom/dicom.html">DICOM</a> data are initially shown 
  as image with thresholds: (&ndash;1000,0),(300,0.9),(3000,1).
  </ul>
<br>
<li>custom presets defined with the
<a href="#nameAppearance"><b>nameAppearance</b></a> option
</ul>
</blockquote>
<blockquote>
  <a href="#top" class="nounder">&bull;</a>
  <a name="nameAppearance"></a>
  <b>nameAppearance</b> &nbsp;<i>preset-name</i>
  <br>
  <a href="#top" class="nounder">&bull;</a>
  <b>nameForget</b> &nbsp;<i>preset-name</i>
<br>
Save (or forget a previously saved) preset for
the <b>image</b> <a href="#style">display style</a>,
including <a href="#general">threshold</a> levels and colors,
<a href="#brightness"><b>brightness</b></a>,
<a href="#transparency"><b>transparency</b></a>, and
<a href="#dimvox"><b>dimTransparentVoxels</b></a> settings.
The <b>nameAppearance</b> option requires specifying
a volume model currently shown in the <b>image</b> style so that its
settings can be saved, for example: 
<blockquote>
<b><a href="#top">volume</a> #1 nameAppearance brain100</b>
</blockquote>
Such user-defined presets are stored in the
<a href="../preferences.html#other">preferences</a> for later application
with the <a href="#appearance"><b>appearance</b></a> option.
Built-in presets (including those available <i>via</i> icons,
see <a href="#appearance">above</a>) can be redefined, but
&ldquo;forgetting&rdquo; their custom definitions with <b>nameForget</b>
will revert to their built-in definitions.
</blockquote>

<a name="defaultvalues"></a>
<p class="nav">
[<a href="#top">back to top: volume</a>]
</p>
<h3>Setting Defaults for New Maps</h3>

<blockquote>
<a href="usageconventions.html"><b>Usage</b></a>:
<b>volume defaultvalues</b> 
[&nbsp;<b>saveSettings</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<b>reset</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
&nbsp;<i>map-options</i>
</blockquote>
<p>
The <b>volume defaultvalues</b> commmand allows users to set default options
for subsequently opened maps. Maps that are already open, if any, will
not be affected. The defaults apply only within the current ChimeraX
session unless <b>saveSettings true</b> is used to save them as user
<a href="../preferences.html#other">preferences</a>.
Using <b>reset true</b> returns all of the relevant settings
to their factory defaults.
Giving <b>volume defaultvalues</b> without arguments
reports the current set of user defaults in the 
<a href="../tools/log.html"><b>Log</b></a>.
See also:
<a href="../tools/volumeviewer.html#initial-display">initial map display</a>
</p><p>
The possible <i>map-options</i> are numerous and described in 
detail in their respective sections:
</p>
<ul>
<li><a href="#general"><b>General Display Options</b></a>:
 <ul>
 <li>initialColors
 <li>showOutlineBox
 <li>OutlineBoxRgb
 </ul>
<li><a href="#sampling"><b>Sampling and Size Options</b></a>
 <ul>
 <li>limitVoxelCount
 <li>voxelLimit
 <li>showOnOpen
 <li>voxelLimitForOpen
 <li>showPlane
 <li>voxelLimitForPlane
 <li>dataCacheSize
 </ul>
<li><a href="#planes"><b>Planes</b></a>
 <ul>
 <li>positionPlanes
 </ul>
<li><a href="#dispsurf"><b>Surface and Mesh Display</b></a>
(all options in section)
 <ul>
 <li>surfaceSmoothing
 <li>smoothingIterations
 <li>smoothingFactor
 <li>subdivideSurface
 <li>subdivisionLevels
 <li>smoothLines
 <li>squareMesh
 <li>dimTransparency
 <li>meshLighting
 <li>twoSidedLighting
 <li>flipNormals
 <li>capFaces
 </ul>
<li><a href="#dispsolid"><b>Image Display</b></a>
 <ul>
 <li>backingColor
 <li>colorMode
 <li>projectionMode
 <li>planeSpacing
 <li>dimTransparentVoxels
 <li>colormapExtendRight
 <li>colormapExtendLeft
 <li>colormapOnGpu
 <li>colormapSize
 <li>fullRegionOnGpu
 <li>blendOnGpu
 <li>maximumIntensityProjection
 <li>btCorrection
 <li>minimalTextureMemory
 <li>linearInterpolation
 <li>tiltedSlabAxis, tiltedSlabOffset, tiltedSlabPlaneCount, tiltedSlabSpacing
 </ul>
</ul>

<a name="vop"></a>
<p class="nav">
[<a href="#top">back to top: volume</a>]
</p>
<h3>Volume Operations (Map Editing)</h3>
<p>
A volume operation edits density maps or other
<a href="../tools/volumeviewer.html">volume data</a>
to create a new volume data set.
The original map is undisplayed and the new map
is displayed with the same threshold and color as the original.
Several of these operations are also implemented as graphical tools
(<i>e.g.</i>, <a href="../tools/mapfilter.html"><b>Map Filter</b></a>).
See also:
<a href="../tools/mapcoords.html"><b>Map Coordinates</b></a>,
<a href="../tools/segment.html"><b>Segment Map</b></a>,
<a href="surface.html#sop"><b>surface</b> operations</a>,
<a href="smoothlines.html"><b>smoothlines</b></a>,
<a href="topography.html"><b>topography</b></a>,
<a href="../tools/densitymaps.html"><b>Map</b></a> icons
</p><p>
Examples:
</p>
<blockquote><b>
volume add #2-25 onGrid #1
<br>vol add #1,2,5 onGrid #5 inPlace true
<br>vol add #1,2 boundingGrid false
<br>vol gaussian #3 sd 5
<br>vol subtract #2 #4 modelId #5
<br>vol unbend #1 path #2 yaxis z xsize 200 ysize 200
</b></blockquote>
<p>
Several operations are available:
</p>
<ul>
<li><a href="#add"><b>volume add</b></a> &ndash; add two or more maps
<li><a href="#bin"><b>volume bin</b></a>
&ndash; reduce data size by averaging over cells of multiple grid points
<li><a href="#boxes"><b>volume boxes</b></a>
&ndash; extract cubic regions centered on
<a href="../markers.html">markers</a> or atoms
<li><a href="#copy"><b>volume copy</b></a>
&ndash; copy map or subregion
<li><a href="#cover"><b>volume cover</b></a>
&ndash; extend map to cover specified atoms or box
<li><a href="#erase"><b>volume erase</b></a>
<a href="../tools/mousemodes.html" title="Right Mouse Toolbar...">
<img class="icon" border=1 src="../tools/mouse-icons/eraser.png"></a>
&ndash; erase (zero or set to other constant) map values inside or outside
a defined sphere 
<li><a href="#falloff"><b>volume falloff</b></a>
&ndash; smooth the boundaries of masked density
<li><a href="#flatten"><b>volume flatten</b></a>
&ndash; scale values to flatten map baseline
<li><a href="#flip"><b>volume flip</b></a>
&ndash; reverse data planes along a specified axis
<li><a href="#fourier"><b>volume fourier</b></a> &ndash; Fourier transform
<li><a href="#gaussian"><b>volume gaussian</b></a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/smooth.png"></a>
&ndash; Gaussian smoothing
<li><a href="#laplacian"><b>volume laplacian</b></a> &ndash; Laplacian filtering
<li><a href="#localCorrelation"><b>volume localCorrelation</b></a>
&ndash; calculate map-map correlation over a sliding box
<li><a href="#mask"><b>volume mask</b></a>
&ndash; mask a map to a surface; 
see also <a href="#onesmask"><b>volume onesmask</b></a>
<li><a href="#maximum"><b>volume maximum</b></a>
&ndash; take the maximum values pointwise from two or more maps
<li><a href="#median"><b>volume median</b></a>
&ndash; set each value to the median of values in a surrounding box
<li><a href="#minimum"><b>volume minimum</b></a>
&ndash; take the minimum values pointwise from two or more maps
<li><a href="#morph"><b>volume morph</b></a>
&ndash; morph (interpolate) between two or more maps
<li><a href="#multiply"><b>volume multiply</b></a>
&ndash; multiply values in two or more maps
<li><a href="#new"><b>volume new</b></a> &ndash; create empty (zero-valued) map;
see also <a href="#onesmask"><b>volume onesmask</b></a>
<li><a href="#cutoctant"><b>volume ~octant</b></a> &ndash; erase positive octant
<li><a href="#octant"><b>volume octant</b></a>
&ndash; erase all but the positive octant
<li><a href="#onesmask"><b>volume onesmask</b></a>
&ndash; create map with values of 1 bounded by a surface
<li><a href="#permuteAxes"><b>volume permuteAxes</b></a> &ndash; permute axes
<li><a href="#resample"><b>volume resample</b></a>
&ndash; resample a map on a different grid
<li><a href="#ridges"><b>volume ridges</b></a>
&ndash; skeletonize; emphasize ridges or filaments in the density
<li><a href="#scale"><b>volume scale</b></a>
&ndash; scale, shift, normalize, and/or cast to a different data value type
<li><a href="#sharpen"><b>volume sharpen</b></a>
&ndash; B-factor sharpening
<li><a href="#splitbyzone"><b>volume splitbyzone</b></a>
&ndash; split map by zones previously colored with
<a href="color.html#zone"><b>color zone</b></a>
<li><a href="#subtract"><b>volume subtract</b></a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/diffmap.png"></a>
&ndash; subtract another map from the first
<li><a href="#threshold"><b>volume threshold</b></a>
&ndash; reassign values that are below a specified minimum
and/or above a specified maximum
<li><a href="#tile"><b>volume tile</b></a>
&ndash; make a single-plane volume from tiled slices of another volume
<li><a href="#unbend"><b>volume unbend</b></a>
&ndash; unbend a map near a path formed by 
<a href="../markers.html">markers/links</a> or atoms/bonds
<li><a href="#unroll"><b>volume unroll</b></a>
&ndash; unroll a cylindrical slab into a flat slab
<li><a href="#unzone"><b>volume unzone</b></a>
&ndash; show the full extent of a map previously limited to a zone with
<a href="#zone"><b>volume zone</b></a>
<li><a href="#zone"><b>volume zone</b></a>
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/volzone.png"></a>
&ndash; limit the display to a zone around specified atoms,
or make a new map with values of zero at grid points within or beyond the zone
</ul>
<a href="#vop" class="nounder">&bull;</a>
<a name="add"><b>volume add</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>scaleFactors</b>&nbsp;&nbsp;<i>f1,f2,...</i>&nbsp;|&nbsp;fromlevels&nbsp;]
[&nbsp;<b>onGrid</b>&nbsp;&nbsp;<i>gridmap</i>&nbsp;]
[&nbsp;<b>spacing</b>&nbsp;&nbsp;<i>S</i>&nbsp;|&nbsp;<i>Sx,Sy,Sz</i>&nbsp;]
[&nbsp;<b>boundingGrid</b>&nbsp;&nbsp;true&nbsp;|&nbsp;false&nbsp;]
[&nbsp;<b>gridStep</b>&nbsp;&nbsp;<i>N</i>&nbsp;|&nbsp;<i>Nx,Ny,Nz</i>&nbsp;]
[&nbsp;<b>gridSubregion</b>&nbsp;&nbsp;<i>i1,j1,k1,i2,j2,k2</i>&nbsp;|&nbsp;<b>all</b>&nbsp;]
[&nbsp;<b>valueType</b>&nbsp;&nbsp;<i>value-type</i>&nbsp;]
[&nbsp;<b>hideMaps</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Add two or more maps to create a new map.
Option keywords are the same as for
<a href="#minimum"><b>volume minimum</b></a>,
<a href="#maximum"><b>volume maximum</b></a>, and
<a href="#multiply"><b>volume multiply</b></a>:
<p>
<a name="scaleFactors"></a>
The <b>scaleFactors</b> keyword indicates multipliers
for each map (default <b>1.0</b>), specified by either:
</p>
<ul>
<li>as many values as input maps, separated by commas but not spaces
<li>the word <b>fromlevels</b>, meaning to scale each map by 1/<i>level</i>, 
where <i>level</i> is the highest surface
<a href="#general">threshold</a> (contour level) of that map;
each map must have a surface with nonzero highest threshold level
</ul>
<p>
The new map can be created on the grid of another map specified with
<b>onGrid</b>, where <i>gridmap</i> is a model number preceded by #.
If <i>gridmap</i> is not specified, it defaults to the first in
<i>volume-spec</i> (the first of the maps being added).
The input maps are resampled on the grid by trilinear interpolation,
and the resulting values summed for each grid point.
Note resampling causes some loss in resolution
(<a href="#notes">details...</a>).
<a name="gridmap-related">Further options related to <i>gridmap</i></a>:
  <ul>
  <li><b>spacing</b> &ndash; use a finer or coarser grid spacing;
  if a single distance value is supplied, it is
  used along all three axes; if three values are supplied
  (separated by commas but not spaces), they
  are used along the X, Y, and Z axes, respectively. 
  Using a finer grid reduces the loss of resolution from resampling
  (<a href="#notes">details...</a>).
  <li><b>boundingGrid</b>
  &ndash; whether to adjust (extend or shrink) the grid of <i>gridmap</i>
  to bound the input maps (default <b>true</b> when adding maps
  without specifying a <i>gridmap</i>, otherwise <b>false</b>)
  <li><b>gridStep</b>
  &ndash; whether to use the full resolution of <i>gridmap</i>
  (step size <b>1</b>, default) or a specified
  subsample (step size &gt; 1).  Step sizes must be integers.
  If a single number is supplied, it is
  used along all three axes; if three numbers are supplied
  (separated by commas but not spaces), they
  are used along the X, Y, and Z axes, respectively.
  <li><b>gridSubregion</b> &ndash; whether to use the full extents 
  of <i>gridmap</i> (<b>all</b>, default) or subregion specified by:
  grid indices
   <i>i1&ndash;i2</i> along the X axis,
   <i>j1&ndash;j2</i> along the Y axis, and
   <i>k1&ndash;k2</i> along the Z axis.
   Grid indices must be integers separated by commas but not spaces.
  Grid indices start at zero.
  </ul>
The <i>value-type</i> defaults to the current type
of the <b>onGrid</b> map (if any), otherwise the first in <i>volume-spec</i>,
and can be 8-, 16-, or 32-bit signed integer
(<b>int8</b>, <b>int16</b>, or <b>int32</b>),
8-, 16-, or 32-bit unsigned integer
(<b>uint8</b>, <b>uint16</b>, or <b>uint32</b>),
or 32- or 64-bit floating-point (<b>float32</b> or <b>float64</b>).
</p><p>
The <b>hideMaps</b> option indicates whether to hide the input maps
(default <b>true</b>).
</p><p>
If the new map is large, for example a whole tomogram, the command may
fail for lack of memory.  The whole new map must fit in memory.
</p>
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="bin"><b>volume bin</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>binSize</b>&nbsp;&nbsp;<i>N</i>&nbsp;|&nbsp;<i>N<sub>x</sub>,N<sub>y</sub>,N<sub>z</sub></i>&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Average over cells of multiple grid points in the original map
to produce a smaller map.  Supplying a single integer N (default <b>2</b>)
indicates partitioning the map into bins of NxNxN grid points and averaging
the N<sup>3</sup> values per bin to produce a new map with
1/N as many points in each dimension.  Cells with different numbers of
grid points in each dimension can be specified by supplying three integers
<i>N<sub>x</sub>,N<sub>y</sub>,N<sub>z</sub></i> separated by commas only.
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="boxes"><b>volume boxes</b></a> &nbsp;<i>volume-spec</i>&nbsp;
<b>centers</b>&nbsp;&nbsp;<a href="atomspec.html"><i>atom-spec</i></a>&nbsp;
[&nbsp;<b>size</b>&nbsp;&nbsp;<i>d</i>&nbsp;|&nbsp;<b>isize</b>&nbsp;&nbsp;<i>n</i>&nbsp;]
[&nbsp;<b>useMarkerSize</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
For each <a href="../markers.html">marker</a>
or atom in <a href="atomspec.html"><i>atom-spec</i></a>,
extract a surrounding cube of data.
If <b>useMarkerSize</b> is false (default),
the edge length of each cube must be specified in physical units
of length with <b>size</b> or in grid units with <b>isize</b>.
If <b>useMarkerSize</b> is true,
the diameter of its central marker or atom is used as the edge length or
added to the <b>size</b> value if also given (default <i>d</i> = <b>0.0</b>).
The <b>isize</b> option facilitates getting the same-sized cubes for
each marker, except where a marker is too close to the edge
of the density map to obtain a cube of the requested size.
If <b>size</b> is used instead, rounding may yield edges
that differ slightly in grid dimensions.
Marker/atom size can be changed with the
<a href="size.html"><b>size</b></a> command.
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="copy"><b>volume copy</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>valueType</b>&nbsp;&nbsp;<i>value-type</i>&nbsp;]
[&nbsp;<a href="#vop-options"><b>subregion</b></a>&nbsp;&nbsp;<i>i1,j1,k1,i2,j2,k2</i>&nbsp;|&nbsp;<b>all</b></a>&nbsp;]
[&nbsp;<a href="#vop-options"><b>step</b></a>&nbsp;&nbsp;<i>N</i>&nbsp;|&nbsp;<i>Nx,Ny,Nz</i>&nbsp;]
[&nbsp;<a href="#vop-options"><b>modelId</b></a>&nbsp;&nbsp;<i>M</i>&nbsp;]
<blockquote>
Copy all or a subregion of a map to a new map.
The <i>value-type</i> defaults to the same as the input map
and can be 8-, 16-, or 32-bit signed integer
(<b>int8</b>, <b>int16</b>, or <b>int32</b>),
8-, 16-, or 32-bit unsigned integer
(<b>uint8</b>, <b>uint16</b>, or <b>uint32</b>),
or 32- or 64-bit floating-point (<b>float32</b> or <b>float64</b>).
The other options are described <a href="#vop-options">below</a>.
See also: <a href="combine.html"><b>combine</b></a>,
<a href="mcopy.html"><b>mcopy</b></a>
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="cover"><b>volume cover</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>atomBox</b>&nbsp;&nbsp;<a href="atomspec.html"><i>atom-spec</i></a>&nbsp;[&nbsp;<b>pad</b>&nbsp;&nbsp;<i>d</i>&nbsp;]]
[&nbsp;<b>box</b>&nbsp;&nbsp;<i>x1,y1,z1,x2,y2,z2</i>&nbsp;]&nbsp;[&nbsp;<b>x</b>&nbsp;&nbsp;<i>x1,x2</i>&nbsp;]&nbsp;[&nbsp;<b>y</b>&nbsp;&nbsp;<i>y1,y2</i>&nbsp;]&nbsp;[&nbsp;<b>z</b>&nbsp;&nbsp;<i>z1,z2</i>&nbsp;]
[&nbsp;<b>fbox</b>&nbsp;&nbsp;<i>a1,b1,c1,a2,b2,c2</i>&nbsp;]&nbsp;[&nbsp;<b>fx</b>&nbsp;&nbsp;<i>a1,a2</i>&nbsp;]&nbsp;[&nbsp;<b>fy</b>&nbsp;&nbsp;<i>b1,b2</i>&nbsp;]&nbsp;[&nbsp;<b>fz</b>&nbsp;&nbsp;<i>c1,c2</i>&nbsp;]
[&nbsp;<b>ibox</b>&nbsp;&nbsp;<i>i1,j1,k1,i2,j2,k2</i>&nbsp;]&nbsp;[&nbsp;<b>ix</b>&nbsp;&nbsp;<i>i1,i2</i>&nbsp;]&nbsp;[&nbsp;<b>iy</b>&nbsp;&nbsp;<i>j1,j2</i>&nbsp;]&nbsp;[&nbsp;<b>iz</b>&nbsp;&nbsp;<i>k1,k2</i>&nbsp;]
[&nbsp;<b>cellSize</b>&nbsp;&nbsp;<i>nx,ny,nz</i>&nbsp;]
[&nbsp;<b>useSymmetry</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
[&nbsp;<a href="#vop-options"><b>modelId</b></a>&nbsp;&nbsp;<i>M</i>&nbsp;]
[&nbsp;<a href="#vop-options"><b>step</b></a>&nbsp;&nbsp;<i>N</i>&nbsp;|&nbsp;<i>Nx,Ny,Nz</i>&nbsp;]
<blockquote>
Extend a map to cover specified atoms or to fill a rectangular box,
using map symmetries and periodicity.
The output dimensions can be specified as:
  <ul>
  <li><b>atomBox</b> spanning the specified atoms
  plus any extra <b>pad</b> in each dimension
  (<i>d</i> is in units of physical distance, default <b>5.0</b>)
  <li><b>box</b> or just individual dimensions <b>x</b>, <b>y</b>, and/or <b>z</b>
  in the X,Y,Z coordinate system of the input map
  <li><b>fbox</b> or just individual dimensions <b>fx</b> <i>etc.</i>
  in fractional coordinates where 0.0-1.0 spans each dimension of the input map
  <li><b>ibox</b> or just individual dimensions <b>ix</b> <i>etc.</i>
  in grid indices of the input map.  The input map's grid indices
  start at 0.
  </ul>
Unspecified dimensions will be kept the same as the input map.
The output grid will have the same spacing and alignment as the grid of the
input map.  The <b>cellSize</b> option
specifies unit cell dimensions in grid units along the X, Y, and Z axes.
The default unit cell dimensions correspond to the full size of the map,
or for CCP4 and MRC maps, are taken from the header.
The <b>useSymmetry</b> option indicates whether to use any symmetries
associated with the map (default <b>true</b>); if false,
only unit cell periodicity will be used.
Map symmetries are read from the CCP4 or MRC file header,
or can be assigned manually with the
<a href="#dimensions"><b>symmetry</b> option of <b>volume</b></a>.
or automatically with
<a href="measure.html#symmetry"><b>measure symmetry</b></a>.
<p>
Values from symmetry copies are determined by trilinear interpolation
(with potential loss in resolution, see <a href="#notes">details</a>).
Where symmetries and periodicity give multiple copies of the input map
overlapping a grid point, the average value will be assigned.
The maximum difference between values from different copies at a grid point
will be reported in the <a href="../tools/log.html"><b>Log</b></a>.
If there are grid points not covered by symmetry or unit cell periodicity,
a message will be sent to the <a href="../tools/log.html"><b>Log</b></a>,
and the points will be assigned values of 0.0.
To ensure complete coverage by symmetry copies,
the asymmetric unit of the map should extend far enough
that its symmetry copies overlap by a non-zero amount.
For example, if the unit cell is 100 grid points wide and there is two-fold
symmetry along the X axis, the asymmetric unit would need to contain
at least 52 grid points along the X axis. If it contains only 50, the two
symmetric copies will not overlap, and values in the space between the
copies cannnot be determined because the current code cannot interpolate
between different copies of the map.
If it contains 51, the two copies will have a single plane of grid points
in common. Although that would be sufficient with exact arithmetic,
the copies still might not overlap given the rounding errors
inherent in computer calculations.
</p>
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="erase"><b>volume erase</b></a> &nbsp;<i>volume-spec</i>&nbsp;
<b>center</b> &nbsp;<a href="pointspec.html#point"><i>point-spec</i></a>&nbsp;
<b>radius</b>&nbsp;&nbsp;<i>r</i>&nbsp;
[&nbsp;<b>value</b>&nbsp;&nbsp;<i>new-value</i>&nbsp;]
[&nbsp;<b>coordinateSystem</b>&nbsp;&nbsp;<i>N</i>&nbsp;]
[&nbsp;<b>outside</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
<!--
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
-->
<blockquote>
Erase (set values to zero, unless a different <i>new-value</i> is given with
the <b>value</b> option) the displayed map at points within a sphere
of the specified <b>center</b> and <b>radius</b>, or if 
<b>outside</b> is <b>true</b>, erase outside the sphere instead. 
Only a single map should be displayed. If the map was read from a file, 
a copy will be generated automatically and displayed (and the original hidden)
so that erasures apply only to the copy. Center coordinates are interpreted in
the <a href="view.html#scenecoords">scene coordinate system</a> unless
the <b>coordinateSystem</b> of model <i>N</i> is specified.
See <a href="../tools/maperaser.html"><b>Map Eraser</b></a>
<a href="../tools/mousemodes.html" title="Right Mouse Toolbar...">
<img class="icon" border=1 src="../tools/mouse-icons/eraser.png"></a>
for placing the sphere interactively.
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="falloff"><b>volume falloff</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>iterations</b>&nbsp;&nbsp;<i>M</i>&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Smooth the boundaries of a masked map by replacing the value
at each grid point outside the boundary with the average of the values
of its six nearest neighbors, for <i>M</i> iterations (default <b>10</b>).
All grid points with values of zero before the first iteration
are taken to be outside the boundary,
thus assigned a new value at each iteration.
Thanks to Greg Pintilie for the initial implementation.
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="flatten"><b>volume flatten</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>method</b>&nbsp;&nbsp;<b>multiply</b>&nbsp;|&nbsp;divide&nbsp;]
[&nbsp;<b>fitregion</b>&nbsp;&nbsp;<i>i1,j1,k1,i2,j2,k2</i>&nbsp;|&nbsp;<b>all</b>&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
If the <b>method</b> is <b>multiply</b> (default),
scale data values by factor (a*i + b*j + c*k + d)
where i,j,k are the grid indices and a,b,c,d are calculated to
zero out the first moments of the resulting map
(make its mass balance at the center of the grid).  If the <b>method</b>
is <b>divide</b>, data values are divided by the factor (a*i + b*j + c*k + d),
which is a least-squares fit to the map data values.
For both methods, the a,b,c,d coefficients are scaled
to make (a*i + b*j +c*k + d) equal to 1 at the center of the map.
If a <b>fitregion</b> is specified, the calculation of
the a,b,c,d coefficients uses only the data values in the specified region,
while the scaling operation applies to the entire map or the part specified
with <a href="#vop-options"><b>subregion</b></a>.
The <b>fitregion</b> can be the full extents of the data (<b>all</b>, default)
or a subregion specified by grid indices
<i>i1&ndash;i2</i> along the X axis,
<i>j1&ndash;j2</i> along the Y axis, and
<i>k1&ndash;k2</i> along the Z axis.
Grid indices must be integers separated by commas but not spaces.
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="flip"><b>volume flip</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>axis</b>&nbsp;&nbsp;x&nbsp;|&nbsp;y&nbsp;|&nbsp;<b>z</b>&nbsp;|&nbsp;xy&nbsp;|&nbsp;yz&nbsp;|&nbsp;xyz&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Reverse data planes along a specified <b>axis</b> (default <b>z</b>,
reversing the order of the Z planes).
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="fourier"><b>volume fourier</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>phase</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Calculate the <a href="#moreft">3D Fourier transform</a>.
If <b>phase</b> is false (default), generate a
magnitude map; if <b>phase</b> is true, generate a map of phase
values (&ndash;&pi; to &pi;) instead.
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="gaussian"><b>volume gaussian</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>sDev</b>&nbsp;&nbsp;<i>&sigma;</i>&nbsp;|&nbsp;<i>&sigma;<font size="-1">x</font>,&sigma;<font size="-1">y</font>,&sigma;<font size="-1">z</font>&nbsp;</i>]
[&nbsp;<b>bfactor</b>&nbsp;&nbsp;<i>B</i>&nbsp;]
[&nbsp;<b>invert</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<b>valueType</b>&nbsp;&nbsp;<i>value-type</i>&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Perform Gaussian filtering,
where <i>&sigma;</i> is one standard deviation of the 3D Gaussian function
in the physical distance units of the map,
typically &Aring; (default <b>1.0</b>).
Different standard deviations along X,Y,Z can be specified as
three values separated by commas only.
Gaussian filtering attenuates high frequencies to smooth the map; however,
the opposite behavior (amplifying the high frequencies to sharpen the map)
can be specified with <b>invert true</b>.
Sharpening with <i>&sigma;</i> values smaller than the pixel size
is most useful; larger values overemphasize high frequencies, in effect
amplifying noise. 
<p>
Alternatively, the width of the Gaussian can be specified with 
<b>bfactor</b>&nbsp;<i>B</i> instead of <b>sDev</b>&nbsp;<i>&sigma;</i>,
where <i>B</i> = 8&pi;<sup>2</sup><i>&sigma;</i><sup>2</sup>.
See also: <a href="#sharpen"><b>volume sharpen</b></a>
<p>
The <i>value-type</i> defaults to the current type
and can be 8-, 16-, or 32-bit signed integer
(<b>int8</b>, <b>int16</b>, or <b>int32</b>),
8-, 16-, or 32-bit unsigned integer
(<b>uint8</b>, <b>uint16</b>, or <b>uint32</b>),
or 32- or 64-bit floating-point (<b>float32</b> or <b>float64</b>).
<p>
Gaussian smoothing improves the ratio of signal to noise but reduces resolution.
It is fastest for data sizes that are powers of 2, and can be very slow
when insufficient memory is available. It may be helpful to limit
the input to just a subsample or subregion of the original data.
Although it uses a fast Fourier transform calculation method,
it does not use map periodicity.
Values outside the map boundaries are treated as zero.
See also:
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/smooth.png"></a>
</p>
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="laplacian"><b>volume laplacian</b></a> &nbsp;<i>volume-spec</i>
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Perform Laplacian filtering.
The Laplacian operation is a sum of second derivatives.
Laplacian filtering is useful for edge detection but
amplifies noise, so it may be necessary to perform smoothing such as
Gaussian filtering beforehand.
Finite differences v(i-1)-2*v(i)+v(i+1) along each axis are used,
and voxels at the edge of the box are set to zero.
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="localCorrelation"><b>volume localCorrelation</b></a>
&nbsp;<i>map</i> &nbsp;<i>othermap</i>&nbsp;
[&nbsp;<b>windowSize</b>&nbsp;&nbsp;<i>N</i>&nbsp;]
[&nbsp;<b>subtractMean</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<a href="#vop-options"><b>modelId</b></a>&nbsp;&nbsp;<i>M</i>&nbsp;]
<blockquote>
Calculate the correlation between two maps over a sliding box of
NxNxN grid points, generating a new map by assigning the correlation value
to the box center.  The sliding box is based on the grid
of the first map, and <i>N</i> = <b>5</b> grid units by default.
If the grids of the two input maps do not coincide, the values of
the second map will be interpolated
(with potential loss in resolution, see <a href="#notes">details</a>).
The <b>subtractMean</b> option specifies whether to subtract the mean
of the values in the window from each value in the window
before calculating the correlation.
The output map will be <i>N</i>&ndash;1 smaller in each dimension than
the first map.
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="mask"><b>volume mask</b></a> &nbsp;<i>volume-spec</i>&nbsp;
<b>surfaces</b> &nbsp;<i>surface-spec</i>&nbsp;
[&nbsp;<b>fullMap</b> &nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<b>pad</b> &nbsp;<i>distance</i>&nbsp;]
[&nbsp;<b>extend</b> &nbsp;<i>N</i>&nbsp;]
[&nbsp;<b>slab</b> &nbsp;<i>width</i>&nbsp;|&nbsp;<i>d1,d2</i>&nbsp;]
[&nbsp;<b>invertMask</b> &nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<b>axis</b> &nbsp;<a href="pointspec.html#vector"><i>vector-spec</i></a>&nbsp;]
[&nbsp;<b>sandwich</b> &nbsp;<b>true</b>&nbsp;|&nbsp;false</a>&nbsp;]
[&nbsp;<b>fillOverlap</b> &nbsp;true&nbsp;|&nbsp;<b>false</b></a>&nbsp;]
[&nbsp;<a href="#vop-options"><b>modelId</b></a>&nbsp;&nbsp;<i>M</i>&nbsp;]
<blockquote>
Mask a map to a surface (<a href="#masking">details...</a>). 
The <b>fullMap</b> option indicates making the new
map dimensions the same as the full dimensions of the original map, even if 
only a subregion is being displayed; otherwise (default), the new map
will be made as small as possible to enclose the surface.
The <b>pad</b> option allows extracting a larger or smaller region by
moving the surface a positive or negative <i>distance</i>
(in the distance units of the data, typically &Aring; or nm) 
along surface normals before creating the masked volume.
However, if the resulting surface intersects itself,
the masked volume will not include the intersection.
For larger-region extraction, this problem can be avoided
by instead using the <b>extend</b> option to move the surface
outward by <i>N</i> voxels before creating the masked volume.
In other words, <b>extend</b> includes grid points that are within <i>N</i> 
grid units (along the grid X, Y, and Z axes) of the original surface.
<p>
The <b>slab</b> option allows instead extracting a slab of data around a surface
layer. Two additional surfaces, displaced as specified from the existing 
surface and joined at their edges (if any), are computed but not displayed.
Data for voxels between the computed surfaces are retained. If a single value
(<i>width</i>) is supplied, the two computed surfaces are offset
along the normals of the original surface by &plusmn;&frac12;(<i>width</i>).
Alternatively, two values separated by a comma but no spaces can be used
to specify the offsets of the two surfaces independently.
Positive or negative values can be used.
</p><p>
The <b>invertMask</b> option allows getting the opposite result (spatial
complement of values and zeros) of what would otherwise be obtained.
</p><p>
The region between surface layers is computed along the projection 
<b>axis</b> (a <a href="pointspec.html#vector">vector</a> 
specified in the map coordinate system, default <b>y</b>). 
The axis direction matters when the surface has holes.
The <b>sandwich</b> option specifies including only volume voxels between
paired surface layers; if false, the volume projected along the axis beyond 
a single surface layer will also be included.
When intersecting or nested surfaces are involved,
the <b>fillOverlap</b> option indicates retaining the union of the values
from masking to each surface separately.
For example, if the surface(s) include two concentric spheres,
<b>fillOverlap</b> true will return values for all grid points within
the larger sphere, whereas <b>fillOverlap</b> false will return values for
only those points in the shell between the two surfaces.
</p><p>
The related command <a href="#onesmask"><b>volume onesmask</b></a> 
creates a new map with values of 1 bounded by a surface.
See also: 
<a href="#multiply"><b>volume multiply</b></a>,
<a href="shape.html"><b>shape</b></a>,
<a href="surface.html#invertShown"><b>surface invertShown</b></a>,
<a href="segmentation.html"><b>segmentation</b></a>,
<a href="segger.html#exportmask"><b>segger&nbsp;exportmask</b></a>,
<a href="../tools/segment.html"><b>Segment Map</b></a>
</p>
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="maximum"><b>volume maximum</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>scaleFactors</b>&nbsp;&nbsp;<i>f1,f2,...</i>&nbsp;|&nbsp;fromlevels&nbsp;]
[&nbsp;<b>onGrid</b>&nbsp;&nbsp;<i>gridmap</i>&nbsp;]
[&nbsp;<b>spacing</b>&nbsp;&nbsp;<i>S</i>&nbsp;|&nbsp;<i>Sx,Sy,Sz</i>&nbsp;]
[&nbsp;<b>boundingGrid</b>&nbsp;&nbsp;true&nbsp;|&nbsp;false&nbsp;]
[&nbsp;<b>gridStep</b>&nbsp;&nbsp;<i>N</i>&nbsp;|&nbsp;<i>Nx,Ny,Nz</i>&nbsp;]
[&nbsp;<b>gridSubregion</b>&nbsp;&nbsp;<i>i1,j1,k1,i2,j2,k2</i>&nbsp;|&nbsp;<b>all</b>&nbsp;]
[&nbsp;<b>valueType</b>&nbsp;&nbsp;<i>value-type</i>&nbsp;]
[&nbsp;<b>hideMaps</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Set each value to the maximum at that point in two or more input maps.
See <a href="#add"><b>volume add</b></a> for descriptions of the options.
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="median"><b>volume median</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>binSize</b>&nbsp;&nbsp;<i>N</i>&nbsp;|&nbsp;<i>N<sub>x</sub>,N<sub>y</sub>,N<sub>z</sub></i>&nbsp;]
[&nbsp;<b>iterations</b>&nbsp;&nbsp;<i>M</i>&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Smooth the data by setting each value to the median of the values
in a box centered at that point.  Values at points for which
the surrounding box extends outside the data are simply set to zero.
Box dimensions are specified in
grid units with <b>binSize</b> and must be odd integers.
Supplying a single integer N (default <b>3</b>)
indicates a box size of NxNxN grid points.
Boxes with different numbers of grid points in each dimension
can be specified by supplying three integers
<i>N<sub>x</sub>,N<sub>y</sub>,N<sub>z</sub></i> separated by commas only.
The <b>iterations</b> option indicates how many cycles of smoothing to
perform (default <b>1</b>).
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="minimum"><b>volume minimum</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>scaleFactors</b>&nbsp;&nbsp;<i>f1,f2,...</i>&nbsp;|&nbsp;fromlevels&nbsp;]
[&nbsp;<b>onGrid</b>&nbsp;&nbsp;<i>gridmap</i>&nbsp;]
[&nbsp;<b>spacing</b>&nbsp;&nbsp;<i>S</i>&nbsp;|&nbsp;<i>Sx,Sy,Sz</i>&nbsp;]
[&nbsp;<b>boundingGrid</b>&nbsp;&nbsp;true&nbsp;|&nbsp;false&nbsp;]
[&nbsp;<b>gridStep</b>&nbsp;&nbsp;<i>N</i>&nbsp;|&nbsp;<i>Nx,Ny,Nz</i>&nbsp;]
[&nbsp;<b>gridSubregion</b>&nbsp;&nbsp;<i>i1,j1,k1,i2,j2,k2</i>&nbsp;|&nbsp;<b>all</b>&nbsp;]
[&nbsp;<b>valueType</b>&nbsp;&nbsp;<i>value-type</i>&nbsp;]
[&nbsp;<b>hideMaps</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Set each value to the minimum at that point in two or more input maps.
See <a href="#add"><b>volume add</b></a> for descriptions of the options.
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="morph"><b>volume morph</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>start</b>&nbsp;&nbsp;<i>start-fraction</i>&nbsp;]
[&nbsp;<b>playStep</b>&nbsp;&nbsp;<i>increment</i>&nbsp;]
[&nbsp;<b>frames</b>&nbsp;&nbsp;<i>N</i>&nbsp;]
[&nbsp;<b>playDirection</b>&nbsp;&nbsp;<b>1</b>&nbsp;|&nbsp;&ndash;1&nbsp;]
[&nbsp;<b>playRange</b>&nbsp;&nbsp;<i>low-fraction,high-fraction</i>&nbsp;]
[&nbsp;<b>scaleFactors</b>&nbsp;&nbsp;<i>f1,f2,...</i>&nbsp;|&nbsp;fromlevels&nbsp;]
[&nbsp;<b>constantVolume</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<b>addMode</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<b>hideOriginalMaps</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
[&nbsp;<b>interpolateColors</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
[&nbsp;<b>slider</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Morph between two or more maps. The morph can be played back with the
<a href="#slider">slider</a> graphical interface.
For a reasonable result, the input maps should have the same grids:
dimensions, spacing, and numbers of points.
Note <a href="#resample"><b>volume resample</b></a>
can be used to make a copy of one map that has the same grid as another.
A morphing fraction of 0.0 corresponds to the first map and a fraction of 1.0
corresponds to the last, with intermediate maps evenly spaced within that range.
There is smooth interpolation between each adjacent pair of maps.
<p>
The morph display will proceed from <i>start-fraction</i> (default <b>0.0</b>)
in steps of <i>increment</i> (default <b>0.04</b>) for <i>N</i> <b>frames</b>
(default <b>25</b>). By default (<b>playDirection 1</b>),
the initial direction of play is from low to high fractions.
If the number of frames and step increment are more than needed to reach
the <b>playRange</b> bounds (default is the entire range: <b>0.0,1.0</b>),
the morph display will &ldquo;bounce&rdquo; back and forth.
The <b>scaleFactors</b> keyword specifies a multiplier for each map
(<a href="#scaleFactors">details...</a>).
The <b>constantVolume</b> option specifies adjusting the
<a href="#general">threshold</a> (contour level)
automatically to keep the enclosed volume constant.
The <b>addMode</b> option specifies treating the second map as a delta
to be added to the first instead of linearly interpolating between the two.
It is not recommended for inputs of &gt;2 maps.
The <b>hideOriginalMaps</b> option specifies hiding the input maps.
The <b>interpolateColors</b> option
only applies when the maps have the same number of
<a href="#general">thresholds</a>
(contour levels for surface/mesh display,
coloring control nodes for image display).
</p><p>
<a name="slider"></a>
The <b>slider</b> option (default <b>true</b>) shows a graphical interface
for volume morph playback.
The slider can be dragged or a frame number entered directly.
The interface also includes a play/pause button, a
&nbsp;<img style="height:16px; margin: 1px -1px; vertical-align:top"
src="../tools/ui-icons/snail.png">&nbsp; value to increase for slower playback,
and a button for recording a movie
(<img class="iconbar" src="../tools/ui-icons/record.png">).
The movie will start at the current slider position, so
to include the whole morph, place the slider at the far left
before clicking the record button.
</p><p>
The morph is created as a new map (volume) model. However, if the
<a href="#vop-options"><b>modelId</b></a> of an existing map is given,
the existing map model will be reused instead of a new one being added.
In other words, to &ldquo;replay&rdquo; a morph without losing its coloring,
zoning, or transparency settings: 
</p>
<ol>
<li>use <b>volume morph</b> an initial time to create the morph model
<li>apply coloring, zoning, <i>etc.</i> as desired to that model
<li>use <b>volume morph</b> again, but this time specifying the
<a href="#vop-options"><b>modelId</b></a> of the existing model so that
its properties will be retained during playback
</ol>
<p>
See also:
<a href="vseries.html"><b>vseries</b></a>,
<a href="morph.html"><b>morph</b></a>,
<a href="../movies.html">making movies</a>
</p>
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="multiply"><b>volume multiply</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>scaleFactors</b>&nbsp;&nbsp;<i>f1,f2,...</i>&nbsp;|&nbsp;fromlevels&nbsp;]
[&nbsp;<b>onGrid</b>&nbsp;&nbsp;<i>gridmap</i>&nbsp;]
[&nbsp;<b>spacing</b>&nbsp;&nbsp;<i>S</i>&nbsp;|&nbsp;<i>Sx,Sy,Sz</i>&nbsp;]
[&nbsp;<b>boundingGrid</b>&nbsp;&nbsp;true&nbsp;|&nbsp;false&nbsp;]
[&nbsp;<b>gridStep</b>&nbsp;&nbsp;<i>N</i>&nbsp;|&nbsp;<i>Nx,Ny,Nz</i>&nbsp;]
[&nbsp;<b>gridSubregion</b>&nbsp;&nbsp;<i>i1,j1,k1,i2,j2,k2</i>&nbsp;|&nbsp;<b>all</b>&nbsp;]
[&nbsp;<b>valueType</b>&nbsp;&nbsp;<i>value-type</i>&nbsp;]
[&nbsp;<b>hideMaps</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Multiply the values pointwise in two or more maps.
This is used to apply a mask (values 0,1) to a map.
See <a href="#add"><b>volume add</b></a> for descriptions of the options.
See also: <a href="#mask"><b>volume mask</b></a>
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="new"><b>volume new</b></a> [&nbsp;<i>map-name</i>&nbsp;]
[&nbsp;<b>size</b>&nbsp;&nbsp;<i>N</i>&nbsp;|&nbsp;<i>Nx,Ny,Nz</i>&nbsp;]
[&nbsp;<b>gridSpacing</b>&nbsp;&nbsp;<i>s</i>&nbsp;|&nbsp;<i>sx,sy,sz</i>&nbsp;]
[&nbsp;<b>origin</b>&nbsp;&nbsp;<i>x,y,z</i>&nbsp;]
[&nbsp;<b>cellAngles</b>&nbsp;&nbsp;<i>&alpha;,&beta;,&gamma;</i>&nbsp;]
[&nbsp;<b>valueType</b>&nbsp;&nbsp;<i>value-type</i>&nbsp;]
[&nbsp;<a href="#vop-options"><b>modelId</b></a>&nbsp;&nbsp;<i>N</i>&nbsp;]
<blockquote>
Create an &ldquo;empty&rdquo; zero-valued map named <i>map-name</i>
(default <b>new</b>)
with the specified <b>size</b> (number of grid points along each axis,
default <b>100</b>), <b>gridSpacing</b> in physical distance units
(default <b>1.0</b> along each axis),
<b>origin</b> coordinates (default <b>0.0,0.0,0.0</b>),
and <b>cellAngles</b> (default <b>90,90,90</b>&deg;;
a single value can be supplied if &alpha; = &beta; = &gamma;).
Grid size and spacing can each be given as a single value to apply to
all three axes or as three values separated by commas only.
If <i>map-name</i> includes spaces, it must be enclosed in quotation marks.
The <i>value-type</i> defaults to <b>float32</b>
and can be 8-, 16-, or 32-bit signed integer
(<b>int8</b>, <b>int16</b>, or <b>int32</b>),
8-, 16-, or 32-bit unsigned integer
(<b>uint8</b>, <b>uint16</b>, or <b>uint32</b>),
or 32- or 64-bit floating-point (<b>float32</b> or <b>float64</b>).
See also: <a href="#onesmask"><b>volume onesmask</b></a>
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="cutoctant"><b>volume ~octant</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>center</b>&nbsp;&nbsp;<i>x,y,z</i>&nbsp;|&nbsp;<b>iCenter</b>&nbsp;<i>i,j,k</i>&nbsp;]
[&nbsp;<b>fillValue</b>&nbsp;&nbsp;<i>value</i>&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Erase values inside the positive octant
(all grid points with X,Y,Z coordinates greater than the center).
The center can be specified in physical units (such as &Aring;) with
<b>center</b> or in grid units with <b>iCenter</b>,
where grid indices start at zero.
The default is the center of the volume data box.
The coordinates should be separated by commas but not spaces, and the
values can be fractional.
<b>iCenter</b> overrides <b>center</b> if both are given.  The
values in the erased regions will be set to <i>value</i> (default <b>0</b>).
A different value may improve contour surface appearance;
for example, large negative values produce flatter surfaces where an
octant has been cut away from a map of positive values.
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="octant"><b>volume octant</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>center</b>&nbsp;&nbsp;<i>x,y,z</i>&nbsp;|&nbsp;<b>iCenter</b>&nbsp;<i>i,j,k</i>&nbsp;]
[&nbsp;<b>fillValue</b>&nbsp;&nbsp;<i>value</i>&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Erase values outside the positive octant. Options are as described for
<a href="#cutoctant"><b>volume ~octant</b></a> above.
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="onesmask"><b>volume onesmask</b></a> &nbsp;<i>surface-spec</i>&nbsp;
[&nbsp;<b>onGrid</b>&nbsp;&nbsp;<i>gridmap</i>&nbsp;]
[&nbsp;<b>fullMap</b> &nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
[&nbsp;<b>border</b>&nbsp;&nbsp;<i>B</i>&nbsp;]
[&nbsp;<b>spacing</b>&nbsp;&nbsp;<i>S</i>&nbsp;|&nbsp;<i>Sx,Sy,Sz</i>&nbsp;]
[&nbsp;<b>valueType</b>&nbsp;&nbsp;<i>value-type</i>&nbsp;]
[&nbsp;<b>pad</b>&nbsp;&nbsp;<i>distance</i>&nbsp;]
[&nbsp;<b>extend</b>&nbsp;&nbsp;<i>N</i>&nbsp;]
[&nbsp;<b>slab</b>&nbsp;&nbsp;<i>width</i>&nbsp;|&nbsp;<i>d1,d2</i>&nbsp;]
[&nbsp;<b>invertMask</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<b>axis</b>&nbsp;&nbsp;<a href="pointspec.html#vector"><i>vector-spec</i></a>&nbsp;]
[&nbsp;<b>sandwich</b>&nbsp; &nbsp;<b>true</b>&nbsp;|&nbsp;false</a>&nbsp;]
[&nbsp;<b>fillOverlap</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b></a>&nbsp;]
[&nbsp;<a href="#vop-options"><b>modelId</b></a>&nbsp;&nbsp;<i>M</i>&nbsp;]
<blockquote>
Create a map with values of 1 bounded by a surface 
(<a href="#masking">details...</a>).
The <b>onGrid</b> option allows creating the new map on the grid
of another map specified by model number, <i>gridmap</i>, using either
its full extents (<b>fullMap true</b>, default) or the smallest 
needed to enclose the surface (<b>fullMap false</b>).
<p>
Alternatively (if <b>onGrid</b> is not used): 
<ul>
<li>the <b>border</b> option indicates how far out from the bounding surface 
in all six directions
(&plusmn;X, &plusmn;Y, &plusmn;Z) to place the edge of the output map
<li>the <b>spacing</b> option gives the grid spacing for the output map
in physical units of length, typically &Aring;
(default is 1% of the maximum of the X, Y, and Z dimensions
of the bounding surfaces). If a single number is supplied, it is used 
in all three directions; if three numbers are supplied (separated by commas 
but not spaces), they are used in the X, Y, and Z directions, respectively.
</ul>
<p>
The <i>value-type</i> defaults to the current type
of the <b>onGrid</b> map (if any), otherwise <b>int8</b>; 
the choices are 8-, 16-, or 32-bit signed integer
(<b>int8</b>, <b>int16</b>, or <b>int32</b>),
8-, 16-, or 32-bit unsigned integer
(<b>uint8</b>, <b>uint16</b>, or <b>uint32</b>),
or 32- or 64-bit floating-point (<b>float32</b> or <b>float64</b>).
The remaining options are the same as described for 
<a href="#mask"><b>volume mask</b></a>. See also:
<a href="#new"><b>volume new</b></a>,
<a href="shape.html"><b>shape</b></a>
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="permuteAxes"><b>volume permuteAxes</b></a>
&nbsp;<i>volume-spec</i>&nbsp;
&nbsp;<i>axis-order</i>&nbsp;
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Permute grid axes to the specified <i>axis-order</i>, which can be
any of the 6 ordered combinations of <b>x</b>, <b>y</b>, and <b>z</b>.
The original order is <b>xyz</b>.
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="ridges"><b>volume ridges</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>level</b>&nbsp;&nbsp;<i>minimum</i>&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Skeletonize map(s) by tracing along high-density grid points to
identify ridges or filamentous structures in the density.
At each grid point, the value is compared to the values of all the points
in the surrounding 3x3x3 box, and the count of how many directions (up to 13)
along which the value is a local maximum is assigned as that point's value
in the new map. The <b>level</b> keyword indicates a
<i>minimum</i> value in the original map below which to
automatically set the new value to 0, essentially ignoring those points
in the skeletonization. The default <i>minimum</i> is the lowest display
<a href="#general">threshold</a>
(contour level) in the original map.
Viewing the new skeleton map with a threshold
of 6-10 highlights ridgelike features in the original map.
<!--
<p>
See also:
<a href="../../ContributedSoftware/volumepathtracer/framevolpath.html"
target="_top"><b>Volume Tracer</b></a>
</p>
-->
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="resample"><b>volume resample</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>onGrid</b>&nbsp;&nbsp;<i>gridmap</i>&nbsp;]
[&nbsp;<b>spacing</b>&nbsp;&nbsp;<i>S</i>&nbsp;|&nbsp;<i>Sx,Sy,Sz</i>&nbsp;]
[&nbsp;<b>boundingGrid</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<b>gridStep</b>&nbsp;&nbsp;<i>N</i>&nbsp;|&nbsp;<i>Nx,Ny,Nz</i>&nbsp;]
[&nbsp;<b>gridSubregion</b>&nbsp;&nbsp;<i>i1,j1,k1,i2,j2,k2</i>&nbsp;|&nbsp;<b>all</b>&nbsp;]
[&nbsp;<b>valueType</b>&nbsp;&nbsp;<i>value-type</i>&nbsp;]
[&nbsp;<b>hideMaps</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Resample values to a different grid using trilinear interpolation.
Resampling causes some loss in resolution (<a href="#notes">details...</a>).
One or both of the following options must be supplied:
<ul>
<li>use the grid of another map specified with <b>onGrid</b>,
where <i>gridmap</i> is a model number preceded by #
<li>use a finer or coarser <b>spacing</b> of points on the grid;
if a single distance value is supplied, it is
used along all three axes; if three values are supplied
(separated by commas but not spaces), they
are used along the X, Y, and Z axes, respectively. 
Using a finer grid reduces the loss of resolution from resampling
(<a href="#notes">details...</a>).
</ul>
<p>
The other arguments are as described
<a href="#gridmap-related">above</a> for <a href="#add"><b>volume add</b></a>.
</p>
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="scale">
<b>volume scale</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>shift</b>&nbsp;&nbsp;<i>constant</i>&nbsp;]
[&nbsp;<b>factor</b>&nbsp;&nbsp;<i>f</i>&nbsp;]
[&nbsp;<b>rms</b>&nbsp;&nbsp;<i>new-rms</i>&nbsp;|&nbsp;<b>sd</b>&nbsp;<i>new-std-dev</i>&nbsp;]
[&nbsp;<b>valueType</b>&nbsp;&nbsp;<i>value-type</i>&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Shift values by adding a <i>constant</i> (default <b>0.0</b>),
scale values by a multiplicative factor <i>f</i> (default <b>1.0</b>),
and/or cast them to a different data value type.
When values are both shifted and scaled, the shift is applied first.
Two normalization options calculate a scaling factor from the data:
  <ul>
  <li><b>rms</b> &ndash; scale values to make <i>new-rms</i> =
  ((&sum;<i>x</i><font size="-1"><sup>2</sup></font>)/N)<sup>&frac12;</sup>
  where <i>x</i> is each value and N is the total number of values
  <li><b>sd</b> &ndash; first shift values so that the mean is 0.0,
  then scale values to make <i>new-std-dev</i> =
  ((&sum;<i>x</i><font size="-1"><sup>2</sup></font>)/N)<sup>&frac12;</sup>
  </ul>
If a <b>factor</b> <i>f</i> is also specified, it is applied last.
The <i>value-type</i> defaults to the current type
and can be 8-, 16-, or 32-bit signed integer
(<b>int8</b>, <b>int16</b>, or <b>int32</b>),
8-, 16-, or 32-bit unsigned integer
<b>uint8</b>, <b>uint16</b>, or <b>uint32</b>),
or 32- or 64-bit floating-point (<b>float32</b> or <b>float64</b>).
<p>
See also:
<a href="#general"><b>rmsLevel, sdLevel</b>
options of <b>volume</b></a>,
<a href="measure.html#mapstats"><b>measure mapstats</b></a>
</p>
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="sharpen"><b>volume sharpen</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>sDev</b>&nbsp;&nbsp;<i>&sigma;</i>&nbsp;|&nbsp;<i>&sigma;<font size="-1">x</font>,&sigma;<font size="-1">y</font>,&sigma;<font size="-1">z</font>&nbsp;</i>]
[&nbsp;<b>bfactor</b>&nbsp;&nbsp;<i>B</i>&nbsp;]
[&nbsp;<b>invert</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<b>valueType</b>&nbsp;&nbsp;<i>value-type</i>&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Perform B-factor sharpening. 
This amplifies high frequencies by dividing by a Gaussian in frequency space.
The width of the Gaussian can be specified with
<b>bfactor</b>&nbsp;<i>B</i>, which is in units of &Aring;<sup>2</sup>
and relates to the real-space standard deviation <i>&sigma;</i> 
of the function according to 
<i>B</i> = 8&pi;<sup>2</sup><i>&sigma;</i><sup>2</sup>.
Alternatively, the width can be specified with <b>sDev</b>&nbsp;<i>&sigma;</i>
(default <b>1.0</b> &Aring;). Different standard deviations along X,Y,Z 
can be specified as three values separated by commas only.
Sharpening amplifies high frequencies; however, the opposite behavior
(damping the high frequencies to smooth the map)
can be specified with <b>invert true</b>.
Sharpening with <i>&sigma;</i> values smaller than the pixel size
is most useful; larger values overemphasize high frequencies, in effect
amplifying noise.
<p>
All other options are the same
as described for <a href="#gaussian"><b>volume gaussian</b></a> above.
See also:
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/smooth.png"></a>
</p>
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="splitbyzone">
<b>volume splitbyzone</b></a> &nbsp;<i>volume-spec</i>&nbsp;
<blockquote>
Split a map by zones previously colored with
<a href="color.html#zone"><b>color zone</b></a>. A new map is created 
for each distinct color and for the &ldquo;uncolored&rdquo; zone 
(any parts of the original map not within a color zone). 
Values outside the respective zones are set to zero. 
The new data sets are created as submodels of a new model
named by appending &ldquo;split&rdquo; to the name of the original map.
See also: <a href="../tools/segment.html"><b>Segment Map</b></a>
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="subtract"><b>volume subtract</b></a>
&nbsp;<i>map</i> &nbsp;<i>othermap</i>&nbsp;
[&nbsp;<b>scaleFactors</b>&nbsp;&nbsp;<i>f1,f2</i>&nbsp;|&nbsp;fromlevels&nbsp;]
[&nbsp;<b>minRms</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<b>onGrid</b>&nbsp;&nbsp;<i>gridmap</i>&nbsp;]
[&nbsp;<b>spacing</b>&nbsp;&nbsp;<i>S</i>&nbsp;|&nbsp;<i>Sx,Sy,Sz</i>&nbsp;]
[&nbsp;<b>boundingGrid</b>&nbsp;&nbsp;true&nbsp;|&nbsp;false&nbsp;]
[&nbsp;<b>gridStep</b>&nbsp;&nbsp;<i>N</i>&nbsp;|&nbsp;<i>Nx,Ny,Nz</i>&nbsp;]
[&nbsp;<b>gridSubregion</b>&nbsp;&nbsp;<i>i1,j1,k1,i2,j2,k2</i>&nbsp;|&nbsp;<b>all</b>&nbsp;]
[&nbsp;<b>valueType</b>&nbsp;&nbsp;<i>value-type</i>&nbsp;]
[&nbsp;<b>hideMaps</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Subtract the values of <i>othermap</i> from <i>map</i>, both specified by
model number preceded by #.
The <b>scaleFactors</b> option specifies multipliers for the two maps, either:
</p>
<ul>
<li><i>f1</i> and <i>f2</i> for <i>map</i> and <i>othermap</i>, respectively,
separated by a comma but not a space
<li>the word <b>fromlevels</b>, meaning to scale each map by 1/<i>level</i>, 
where <i>level</i> is the highest surface
<a href="#general">threshold</a> (contour level) of that map;
each map must have a surface with nonzero highest threshold level
</ul>
<p>
Alternatively to using <b>scaleFactors</b>,
if <b>minRms</b> is true, <i>othermap</i> will be
scaled automatically to minimize the root-mean-square sum
of the resulting (subtracted) values at grid points
within the lowest contour of <i>othermap</i>.
</p><p>
The new map can be created on the grid of another map specified with
<b>onGrid</b>, where <i>gridmap</i> is a model number preceded by #.
If <i>gridmap</i> is not specified, it defaults to <i>map</i>.
The input maps are resampled on the grid by trilinear interpolation,
and the resulting values subtracted for each grid point.
Note resampling causes some loss in resolution
(<a href="#notes">details...</a>).
</p><p>
The remaining arguments are as described
<a href="#gridmap-related">above</a> for <a href="#add"><b>volume add</b></a>,
except that <b>boundingGrid</b> always defaults to <b>false</b>.
When subtraction from an unsigned-integer map could give negative numbers,
the <b>valueType</b> option should be used to specify a signed data type
for the result.
</p><p>
See also:
<a href="../tools/densitymaps.html" title="Map Toolbar...">
<img class="icon" border=1 src="../tools/shortcut-icons/diffmap.png"></a>,
the <a href="fitmap.html#subtractMaps"><b>subtractMaps</b> option of 
<b>fitmap</b></a>
</p>
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="threshold"><b>volume threshold</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>minimum</b>&nbsp;&nbsp;<i>min</i>&nbsp;]
[&nbsp;<b>set</b>&nbsp;&nbsp;<i>newmin</i>&nbsp;]
[&nbsp;<b>maximum</b>&nbsp;&nbsp;<i>max</i>&nbsp;]
[&nbsp;<b>setMaximum</b>&nbsp;&nbsp;<i>newmax</i>&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Replace all values that are below a <b>mininum</b> value (<i>min</i>)
with <i>newmin</i> (default equal to <i>min</i>),
and/or
replace all values that are above a <b>maximum</b> value (<i>max</i>)
with <i>newmax</i> (default equal to <i>max</i>).
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="tile"><b>volume tile</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>axis</b>&nbsp;&nbsp;x&nbsp;|&nbsp;y&nbsp;|&nbsp;<b>z</b>&nbsp;]
[&nbsp;<b>pstep</b>&nbsp;&nbsp;<i>n</i>&nbsp;]
[&nbsp;<b>trim</b>&nbsp;&nbsp;<i>i</i>&nbsp;]
[&nbsp;<b>rows</b>&nbsp;&nbsp;<i>r</i>&nbsp;]
[&nbsp;<b>columns</b>&nbsp;&nbsp;<i>c</i>&nbsp;]
[&nbsp;<b>fillOrder</b>&nbsp;&nbsp;<i>order</i>&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Create a single-plane volume by tiling slices
of a specified volume perpendicular to the specified <b>axis</b>
(default <b>z</b>).  The spacing of slices in grid units
(default <b>1</b>) is given with the <b>pstep</b> keyword.
The <b>trim</b> keyword indicates each slice should be trimmed
on all four edges by <i>i</i> grid units (default <b>0</b>).
The slices are arranged into a single plane with number of
<b>rows</b> <i>r</i> and number of <b>columns</b> <i>c</i>.
If neither the number of rows nor the number of columns is supplied, they
are computed to produce as near a square tiling as possible.  If one or
the other is supplied, the remaining parameter is adjusted to accommodate
the total number of slices. The <b>fillOrder</b> setting
(default <b>ulh</b>) specifies the tiling pattern,
including the starting corner, the tiling direction (horizontal or vertical),
and whether to reverse the order of slices.  The first two characters
specify the corner for the first tile, the first character being <b>u</b> for
upper or <b>l</b> for lower and the second being <b>l</b> for left or <b>r</b>
for right. These directions are defined with the specified
axis pointing at the viewer and the remaining two axes pointing up
and right. The third character is <b>h</b> for horizontal tiling or <b>v</b>
for vertical tiling. The optional fourth character <b>r</b> indicates
that the order of the slices should be reversed. The resulting volume
data set has the same origin and orientation of axes as the original volume,
and grid size 1 along the specified axis.
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="unbend"><b>volume unbend</b></a> &nbsp;<i>volume-spec</i>&nbsp;
<b>path</b>&nbsp;&nbsp;<i>path-spec</i>&nbsp;
[&nbsp;<b>yaxis</b>&nbsp;&nbsp;<a href="pointspec.html#vector"><i>vector-spec</i></a>&nbsp;]
[&nbsp;<b>xsize</b>&nbsp;&nbsp;<i>xs</i>&nbsp;]
[&nbsp;<b>ysize</b>&nbsp;&nbsp;<i>ys</i>&nbsp;]
[&nbsp;<b>gridSpacing</b>&nbsp;&nbsp;<i>s</i>&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Unbend a map near a path formed by <a href="../markers.html">markers/links</a>
or (equivalently) atoms/bonds. The <i>path-spec</i> should be an
<a href="atomspec.html"><i>atom-spec</i></a> that specifies
a single chain of atoms (markers) connected by bonds (links).
The path will be mapped to the Z axis of the result.
The <b>yaxis</b> setting indicates which axis in the existing
volume should be mapped to the Y axis of the result, and can be given as
<b>x</b>, <b>y</b> (default), <b>z</b> or any of the other
standard <a href="pointspec.html#vector">vector specifications</a>.
The <b>gridSpacing</b> <i>s</i> is the separation between grid points in
the new map (default is the minimum spacing along the three axes of the
input map).  The <b>xsize</b> <i>xs</i> and <b>ysize</b> <i>ys</i> are
the X and Y dimensions of the new map in physical units, typically &Aring;
(default 10 times the new grid spacing).
A cubic spline is placed through the path points and the input
volume is interpolated on planes perpendicular to the splined path.
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="unroll"><b>volume unroll</b></a> &nbsp;<i>volume-spec</i>&nbsp;
[&nbsp;<b>center</b>&nbsp;&nbsp;<a href="pointspec.html#point"><i>point-spec</i></a>&nbsp;]
[&nbsp;<b>axis</b>&nbsp;&nbsp;<a href="pointspec.html#vector"><i>vector-spec</i></a>&nbsp;]
[&nbsp;<b>coordinateSystem</b>&nbsp;&nbsp;<i>N</i>&nbsp;]
[&nbsp;<b>length</b>&nbsp;&nbsp;<i>d</i>&nbsp;]
[&nbsp;<b>innerRadius</b>&nbsp;&nbsp;<i>r1</i>&nbsp;]
[&nbsp;<b>outerRadius</b>&nbsp;&nbsp;<i>r2</i>&nbsp;]
[&nbsp;<b>gridSpacing</b>&nbsp;&nbsp;<i>s</i>&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
Unroll a hollow cylindrical section of the map into a flat slab.
Cylinder <b>axis</b> (default <b>z</b>) 
and <b>center</b> (default <b>0,0,0</b>) coordinates
are interpreted in the coordinate system of the input map,
unless another reference model is specified with <b>coordinateSystem</b>.
The dimensions of the cylindrical slab
are given in physical units of length, typically &Aring;:
<b>length</b> <i>d</i> (default is the map extent parallel to the cylinder axis)
and inner and outer radii <i>r1</i> and <i>r2</i>
(defaults are 90% of the smallest radius and 110% of the largest radius
of the displayed isosurface, respectively, given the cylinder center and
axis direction).
The flattening is done by interpolating values from the original map
on a cylindrical grid of points, then unwrapping the cylindrical grid
into a rectangular grid.
The cylinder radial direction becomes the X-axis of the new map,
circumference the Y-axis, and cylinder axis direction the Z-axis.
The <b>gridSpacing</b> <i>s</i> is the requested separation of
grid points along each axis in the new map
(default is the minimum spacing along the three axes of the input map).
The actual spacing may be slightly different
because the dimensions of the new map may not be an exact
multiple of the requested value;
the number of grid divisions along each axis is chosen to give spacing
as close as possible to the requested value without being smaller.
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="unzone"><b>volume unzone</b></a> &nbsp;<i>volume-spec</i>&nbsp;
<blockquote>
Show the full extent of a map that was previously limited to a zone using
<a href="#zone"><b>volume zone</b></a> with option <b>newMap</b> <b>false</b>.
</blockquote>

<a href="#vop" class="nounder">&bull;</a>
<a name="zone"><b>volume zone</b></a> &nbsp;<i>volume-spec</i>&nbsp;
<b>nearAtoms</b>&nbsp;&nbsp;<a href="atomspec.html"><i>atom-spec</i></a>&nbsp;
[&nbsp;<b>range</b>&nbsp;&nbsp;<i>r</i>&nbsp;]
[&nbsp;<b>invert</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<b>minimalBounds</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<b>bondPointSpacing</b>&nbsp;<i>s</i>&nbsp;]
[&nbsp;<b>newMap</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
&nbsp;<a href="#vop-options"><i>new-map-options</i></a>
<blockquote>
If <b>newMap</b> is <b>false</b> (default),
limit the surface display to a zone within <b>range</b> <i>r</i> 
(default <b>3.0</b> &Aring;) of any atom in 
<a href="atomspec.html"><i>atom-spec</i></a> and restrict the
current <a href="../tools/volumeviewer.html#region">display region</a>
of the map to the box containing the zoned surface. The corresponding
<a href="../tools/densitymaps.html"><b>Map</b></a> icon
<img class="icon" border=1 src="../tools/shortcut-icons/volzone.png">
uses a <b>range</b> value six times the grid spacing of the map.
The full extent of the map can be restored with
<a href="#unzone"><b>volume unzone</b></a>.
The <b>invert</b> option is not available with <b>newMap false</b>.
<p>
If <b>newMap</b> is <b>true</b>, create a new map in which the
values of grid points beyond the zone are set to zero, 
or if <b>invert</b> is true, with values within the zone set to zero.
If <b>minimalBounds</b> is true, make the resulting map
as small as possible while enclosing the zone; otherwise, the
dimensions will be the same as for the input map.
If <b>bondPointSpacing</b> is specified, use points
spaced <i>s</i> &Aring; apart along bonds
in addition to the atoms to define the zone.
See also:
<a href="surface.html#zone"><b>surface zone</b></a>,
<a href="zone.html"><b>zone</b></a>,
the <b>zone</b> <a href="ui.html#mousemode">mouse mode</a>
<a href="../tools/mousemodes.html" title="Right Mouse Toolbar...">
<img class="icon" border=1 src="../tools/mouse-icons/zone.png"></a>
</p>
</blockquote>

<a name="vop-options"></a>
<h3>New-Map Options</h3>

<blockquote>
  <b>modelId</b> &nbsp;<i>N</i>
  <br>Open the new data set as model number <i>N</i> (an integer, optionally
  preceded by #).  The default is the lowest unused number.
</blockquote>
<blockquote>
  <a name="step"><b>step</b> &nbsp;<i>N</i> | <i>Nx,Ny,Nz</i></a>
  <br>Whether to use the full resolution of the data
  (step size <b>1</b>, default) or a specified subsample
  (step size &gt; 1).  Step sizes must be integers.
  A step size of 1 indicates all data points,
  2 indicates every other data point, 3 every third point, <i>etc.</i>
  If a single number is supplied, it is
  used along all three axes; if three numbers are supplied
  (separated by commas but not spaces), they
  are used along the X, Y, and Z axes, respectively.
</blockquote>
<blockquote>
  <a name="subregion"><b>subregion</b>
  &nbsp;<i>i1,j1,k1,i2,j2,k2</i> | <b>all</b></a>
  <br>Whether to use the full extents of the data (<b>all</b>, default)
  or a subregion specified by grid indices
  <i>i1&ndash;i2</i> along the X axis,
  <i>j1&ndash;j2</i> along the Y axis, and
  <i>k1&ndash;k2</i> along the Z axis.
  Grid indices must be integers separated by commas but not spaces.
  Grid indices start at zero.
</blockquote>
<blockquote>
  <b>inPlace</b> true&nbsp;|&nbsp;<b>false</b>
  <br>Whether to overwrite the existing data set instead of
  creating a new one.
  *Not all <a href="#vop">volume operations</a> accept this option.*
  Regardless of this setting, the existing data
  will only be overwritten if it was created in ChimeraX
  (for example, with a previous volume operation)
  rather than read from a file.  In the case of map
  <a href="#add">addition</a>, the model to overwrite is the <i>gridmap</i>
  (the model whose grid will be used for the result).
</blockquote>

<a name="notes"></a>
<p class="nav">
[<a href="#top">back to top: volume</a>]
</p>
<h3>Notes</h3>
<p>
<b>Resampling and loss of resolution</b>.
There is some loss of resolution with resampling a map on a different grid
with trilinear interpolation. The effect is similar to smoothing.
The amount of reduction in resolution depends on
the initial resolution, the initial and final grid spacing,
the &ldquo;bumpiness&rdquo; of the data, and the shift between the grids.
For example, starting with a 6-&Aring; resolution map with 2-&Aring;
spacing from <a href="molmap.html"><b>molmap</b></a> and resampling on
a grid (with the same spacing) shifted by 1 &Aring; reduced resolution
to approximately 7.7 &Aring;.  Starting with a 6-&Aring; resolution map with
1-&Aring; spacing and resampling on a grid shifted by 0.5 &Aring; reduced
resolution to approximately 6.4 &Aring;.
Resampling to a finer grid can be specified with the <b>spacing</b> option
of the command.
</p><p>
<a name="transferfunction"><b>Transfer function</b></a>.
For <a href="#dispsolid"><b>image</b></a> displays, the thresholds 
and connecting lines on the histogram define a <b><i>transfer function</i></b>
that maps data values to colors and intensities.
For each voxel, the data value is compared to the thresholds on the histogram.
The colors and intensities of the closest threshold at a lower data value 
(to the left) and the closest threshold at a higher data value (to the right)
are linearly interpolated. 
Color is defined by red, green, blue and opacity components.
The intensity at a threshold is further scaled by its vertical position,
where 0 is the bottom of the histogram and 1 is the top. 
Unless the function is <a href="#colormapExtendRight">extended</a>
horizontally to the maximum and/or minimum value,
voxels with data values greater than the rightmost threshold or 
less than the leftmost threshold are colorless and completely transparent.
Rendering time does not depend on the positions of the thresholds, 
but increases with greater numbers of thresholds.
</p><p>
<a name="soliddetails"><b>Image transparency details</b></a>.
For <a href="#dispsolid"><b>image</b></a> displays,
the <a href="#transferfunction">transfer function</a> maps a
voxel's data value to a vertical position (ranging from 0 to 1)
on the histogram. A lower position indicates more transparency:
<blockquote>
<b>T<sub>histogram</sub></b> = 1 &ndash; vertical position
</blockquote>
The <a href="#general"><b>volume</b></a> command 
<a href="#transparency">transparency</a> option gives the slab thickness 
(expressed as a fraction of dataset thickness along its shortest dimension)
for which the transparency or fraction of light transmitted matches 
<b>T<sub>histogram</sub></b>. Image displays are rendered as stacks of planes.
If the slab thickness specified with <a href="#transparency">transparency</a> 
contains <i>p</i> planes, the following gives the transparency per pixel
in each plane:
</p>
<blockquote>
<b>T<sub>pixel</sub></b> = <b>T<sub>histogram</sub></b><sup>(1/<i>p</i>)</sup>
</blockquote>
<p>
<a name="byteorder"><b>Byte order</b></a>.
Different computers store the bytes of a single numeric value in
different orders.  PowerPC processors use one order
(called big-endian), while Intel/AMD x86 family processors use the
opposite order (called little-endian).
If a binary data file is created on one machine and read on
another having the opposite byte order, byte-swapping is required
to get the correct numeric values.
The DSN6 file reader assumes that the file was written in big-endian byte
order.  DSN6 files can be read on big- or little-endian machines.
All of the other file readers detect file byte order and machine byte order,
then perform byte-swapping if necessary.
</p><p>
<a name="moreft"><b>Fourier transform</b>.</a>
Only the magnitudes of the complex Fourier components are included in the
new data set; the phases are discarded and the constant component is set to
zero. The box containing the Fourier transform
(with axes in units of reciprocal space) is centered on the original data
and scaled to have the same total volume.
Some properties of the original data are evident from the Fourier transform.
High-frequency components are near the edges of the box,
low-freqency components near the center.
Volume data is typically oversampled (voxel size two to three times smaller
than the actual data resolution) and this causes the Fourier transform
to have nonzero values only in the middle half or third of its bounding box.
The missing wedge in electron microscope tomograms can also be seen.
Spikes radiating along the principal axes in the Fourier transform are
caused by nonperiodicity of the original data.
</p><p>
<a name="masking"><b>Mask algorithm</b>.</a>
The masked volume is computed by finding where lines
parallel to the projection <b>axis</b> intersect the surface(s).
For a given line, the volume data between the 1st and 2nd,
3rd and 4th, 5th and 6th, ... points of intersection are included
in the masked volume,
while those between the 2nd and 3rd, 4th and 5th, ... are excluded
(unless there are intersecting or nested surfaces
and <b>fillOverlap</b> is set to true).
The calculation uses a set of parallel lines that pass through points
on a rectangular grid perpendicular to the projection axis.
If the projection is along a data axis (data X, Y, or Z), the
lines will pass through the grid points of the data; otherwise,
lines along the projection axis with spacing equal to the minimum
grid plane spacing of the data will be used.
For each volume voxel, the intersections of the closest grid line 
are used to determine inclusion in the masked volume. 
If there is an odd number of intersections, then points beyond 
the final one are not included in the masked volume
unless the <b>sandwich</b> option is set to false.
In the new data set, values outside the masked region are set to zero
and those inside are set to the original volume values
(for <a href="#mask"><b>volume mask</b></a>) or 1
(for <a href="#onesmask"><b>volume onesmask</b></a>).
The grid points of the calculated volume align exactly with those of
the original volume, if any.
</p>
<hr>
<address>UCSF Resource for Biocomputing, Visualization, and Informatics / 
November 2023</address>
</body></html>
