<html>

<!--
=== UCSF ChimeraX Copyright ===
Copyright 2016 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  For details see:
http://www.rbvi.ucsf.edu/chimerax/docs/licensing.html
This notice must be embedded in or attached to all copies,
including partial copies, of the software or any revisions
or derivations thereof.
=== UCSF ChimeraX Copyright ===
-->

<head>
<link rel="stylesheet" type="text/css" href="../userdocs.css" />
<title>Command: build</title>
</head><body>

<a name="top"></a>
<a href="../index.html">
<img width="60px" src="../ChimeraX-docs-icon.svg" alt="ChimeraX docs icon"
class="clRight" title="User Guide Index"/></a>

<h3><a href="../index.html#commands">Command</a>: build</h3>
<!--
<h3 class="usage"><a href="usageconventions.html">Usage</a>:
<br><b>build start</b>
&nbsp;<a href="atomspec.html"><i>atom</i></a>&nbsp;
[&nbsp;<a href="atomspec.html"><i>model</i></a>&nbsp;|&nbsp;<i>new-model-name</i>&nbsp;]
[&nbsp;<b>resName</b>&nbsp;&nbsp;<i>resname</i>&nbsp;]
[&nbsp;<b>select</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
</h3>
<h3 class="usage"><a href="usageconventions.html">Usage</a>:
<br><b>build modify</b>
&nbsp;<a href="atomspec.html"><i>atom</i></a>&nbsp;
&nbsp;<i>element</i>&nbsp;
&nbsp;<i>numBonds</i>&nbsp;
[&nbsp;<b>geometry</b>&nbsp;&nbsp;ion&nbsp;|&nbsp;single&nbsp;|&nbsp;linear&nbsp;|&nbsp;trigonal&nbsp;|&nbsp;tetrahedral&nbsp;]
[&nbsp;<b>connectBack</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
[&nbsp;<b>colorByElement</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
[&nbsp;<b>name</b>&nbsp;&nbsp;<i>name</i>&nbsp;]
[&nbsp;<b>newRes</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<b>resName</b>&nbsp;&nbsp;<i>resname</i>&nbsp;]
</h3>
<h3 class="usage"><a href="usageconventions.html">Usage</a>:
<br><b>build join peptide</b>
&nbsp;<a href="atomspec.html"><i>atoms</i></a>&nbsp;
[&nbsp;<b>length</b>&nbsp;&nbsp;<i>bond-length</i>&nbsp;]
[&nbsp;<b>omega</b>&nbsp;&nbsp;<i>&omega;</i>&nbsp;]
[&nbsp;<b>phi</b>&nbsp;&nbsp;<i>&phi;</i>&nbsp;]
[&nbsp;<b>move</b>&nbsp;&nbsp;large&nbsp;|&nbsp;<b>small</b>&nbsp;|&nbsp;C&nbsp;|&nbsp;N&nbsp;]
</h3>
-->
<p>
Subcommands of <b>build</b> correspond to sections of
the <a href="../tools/buildstructure.html"><b>Build Structure</b></a> tool:
</p>
<ul>
<li><a href="#start"><b>build start</b></a> 
&ndash; generate a new molecule not bonded to existing atoms
<li><a href="#modify"><b>build modify</b></a>
&ndash; change an existing atomic structure
<li><a href="#join"><b>build join</b></a>
&ndash; add a covalent bond (currently <b>peptide</b> only)
between two atomic models to form a single model
</ul>
<p>
See also: 
<a href="addh.html"><b>addh</b></a>,
<a href="bond.html"><b>bond</b></a>,
<a href="angle.html"><b>angle</b></a>,
<a href="torsion.html"><b>torsion</b></a>,
<a href="delete.html"><b>delete</b></a>,
<a href="swapaa.html"><b>swapaa</b></a>,
<a href="altlocs.html"><b>altlocs</b></a>,
<a href="combine.html"><b>combine</b></a>,
<a href="renumber.html"><b>renumber</b></a>,
<a href="changechains.html"><b>changechains</b></a>,
<a href="open.html"><b>open</b></a>,
<a href="rna.html"><b>rna</b></a>
</p><p>

<a href="#top" class="nounder">&bull;</a>
<a name="start"></a>
<b>build start</b> <b>atom</b>
&nbsp;<i>model-info</i>&nbsp;
[&nbsp;<b>position</b>&nbsp;&nbsp;<i>x,y,z</i>&nbsp;]
[&nbsp;<b>resName</b>&nbsp;&nbsp;<i>resname</i>&nbsp;]
[&nbsp;<b>select</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
<br>
<a href="#top" class="nounder">&bull;</a>
<b>build start</b> <b>fragment</b>
&nbsp;<i>model-info</i>&nbsp;
&nbsp;<i>fragment-name</i></b>&nbsp;
[&nbsp;<b>position</b>&nbsp;&nbsp;<i>x,y,z</i>&nbsp;]
[&nbsp;<b>resName</b>&nbsp;&nbsp;<i>resname</i>&nbsp;]
<br>
<a href="#top" class="nounder">&bull;</a>
<b>build start</b> <b>peptide</b>
&nbsp;<i>model-info</i> &nbsp;<i>sequence</i>&nbsp;
&nbsp;<i>&phi;<sub><font size="-1">1</font></sub>,&psi;<sub><font size="-1">1</font></sub></i>&nbsp;
&nbsp;<i>&phi;<sub><font size="-1">2</font></sub>,&psi;<sub><font size="-1">2</font></sub></i>&nbsp;
... &nbsp;<i>&phi;<sub><font size="-1">N</font></sub>,&psi;<sub><font size="-1">N</font></sub></i>&nbsp;
[&nbsp;<b>position</b>&nbsp;&nbsp;<i>x,y,z</i>&nbsp;]
[&nbsp;<b>chainId</b>&nbsp;&nbsp;<i>ID</i>&nbsp;]
[&nbsp;<b>rotLib</b>&nbsp;&nbsp;&nbsp;<i>rotamer-library</i>&nbsp;]
<br>
<a href="#top" class="nounder">&bull;</a>
<b>build start</b> <b>nucleic</b>
&nbsp;<i>model-info</i> &nbsp;<i>sequence</i>&nbsp;
[&nbsp;<b>position</b>&nbsp;&nbsp;<i>x,y,z</i>&nbsp;]
[&nbsp;<b>type</b>&nbsp;&nbsp;<b>dna</b>&nbsp;|&nbsp;rna&nbsp;|&nbsp;hybrid&nbsp;]
[&nbsp;<b>form</b>&nbsp;&nbsp;A&nbsp;|&nbsp;<b>B</b>&nbsp;]
<blockquote>
For starting a new molecule with <b>build start</b>, the choices are
<b>atom</b>, <b>fragment</b>, <b>peptide</b>, or <b>nucleic</b>.
With the <a href="open.html"><b>open</b></a> command, however, a wide variety
of atomic structures for subsequent <a href="#modify">modification</a> can be 
<a href="open.html#fetch">fetched from online sources</a> or modeled from a
<a href="https://www.daylight.com/dayhtml/doc/theory/theory.smiles.html"
target="_blank">SMILES</a> string.
</p><p>
The <i>model-info</i> can be given as the
<a href="atomspec.html#hierarchy">identifier</a> 
of an existing atomic model (for example, #2)
or a character-string name for a new model.
</p><p>
The <b>position</b> of the new atom or new molecule's geometric center
defaults to the current center of view, but can be given as
<i>x,y,z</i> coordinates separated by commas only.
</p><p>
For <b>fragment</b>, both <i>model-info</i> and <i>fragment-name</i> are 
required. Several planar 5- and 6-membered rings and their fused ring
systems are available, with choices for <i>fragment-name</i> as listed in the 
<a href="../tools/buildstructure.html#start"><b>Build Structure</b></a> dialog.
</p><p>
For <b>peptide</b>, the required arguments are <i>model-info</i> and the 
<i>sequence</i> as a string of single-letter amino acid codes 
(upper- or lowercase)
and a list of comma-separated pairs of <i>&phi;,&psi;</i> values,
one pair for each residue, in the same order as in the sequence.
Even though the terminal residues lack either <i>&phi;</i> or <i>&psi;</i>,
a pair of values is required for each residue. 
The &ldquo;extra&rdquo; values for the terminal residues will be ignored.
Example:
</p>
<blockquote>
<b>build start peptide "custom built" ADKLL -57,-47 -57,-47 -57,-47 -57,-47 -57,-47 rotLib Dunbrack</b>
</blockquote>
<p>
For <b>nucleic</b>, the required arguments are <i>model-info</i> and the 
<i>sequence</i> of one strand as a string of single-letter nucleic acid codes 
(upper- or lowercase). The complementary strand of the double helix
will also be built according to the specified <b>type</b> 
(default <b>dna</b>) and <b>form</b> (default <b>B</b>).
For building a <b>hybrid</b> DNA/RNA, the sequence of the DNA strand
should be given. The nucleic acid chains will be assigned 
the first two unused chain IDs of the atomic model.
</p><p>
Further options:
</p>
<ul>
<li><b>resName</b> &ndash; for <b>atom</b> or <b>fragment</b>,
a name for the new residue (default <b>UNL</b>)
<li><b>select</b> &ndash; for <b>atom</b> only, whether to 
<a href="../selection.html">select</a> the new atom (default <b>true</b>),
as may be convenient for subsequent <a href="#modify">modification</a>
</ul>
<p>
Options for <b>peptide</b> only:
</p>
<ul>
<li><b>chainId</b> &ndash; an existing or new chain ID
(default the &ldquo;lowest&rdquo; unused ID)
<li><b>rotLib</b> &ndash; which amino acid sidechain rotamer library to use
(see <a href="swapaa.html#rotLib"><b>swapaa</b></a> for details
and literature citations):
  <ul>
  <li><b>Dunbrack</b> (default)
  <li><b>Dynameomics</b>
  <li><b>Richardson.common</b>
  <li><b>Richardson.mode</b>
  </ul>
</ul>
</blockquote>

<a href="#top" class="nounder">&bull;</a>
<a name="modify"></a>
<b>build modify</b>
&nbsp;<a href="atomspec.html"><i>atom</i></a>&nbsp;
&nbsp;<i>element</i>&nbsp;
&nbsp;<i>numBonds</i>&nbsp;
[&nbsp;<b>geometry</b>&nbsp;&nbsp;ion&nbsp;|&nbsp;single&nbsp;|&nbsp;linear&nbsp;|&nbsp;trigonal&nbsp;|&nbsp;tetrahedral&nbsp;]
[&nbsp;<b>connectBack</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
[&nbsp;<b>colorByElement</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
[&nbsp;<b>name</b>&nbsp;&nbsp;<i>name</i>&nbsp;]
[&nbsp;<b>newRes</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<b>resName</b>&nbsp;&nbsp;<i>resname</i>&nbsp;]
<blockquote>
The <b>build modify</b> command
changes the <a href="../atomtypes.html">type</a>
of a single specified <a href="atomspec.html"><i>atom</i></a>
and automatically fills its valence with attached hydrogens.
The hydrogens could be modified in turn to continue building outward.
The <i>element</i> (<a href="colortables.html#element">element symbol</a>)
and <i>numBonds</i> (total number of bonds to the atom, including hydrogens) 
must also be given, for example:
</p>
<blockquote><b>
build modify 
<a href="atomspec.html#builtin">sel</a> O 2 geometry tetrahedral
</b></blockquote>
<p>
Hydrogens will be added to the atom to generate the indicated 
total number of bonds. They are added to form the idealized bond angles
for the specified <b>geometry</b>,
or if the atom already has two or more substituents, 
to maximally avoid those substituents.
The default geometry is the same as for the atom's
current <a href="../atomtypes.html">type</a>.
Since the geometry around the atom may be changing, any
pre-existing directly attached hydrogens are removed beforehand.
No other atoms are removed automatically. 
If the atom is already bonded to one (and only one) other nonhydrogen atom,
the length of the bond will be adjusted depending on 
the elements involved. No other atoms are moved.
</p><p>
Other options:
</p>
<ul>
<li><b>connectBack</b> (default <b>true</b>) &ndash;
if a newly added hydrogen would be very close to an existing atom 
in the same model, discard the hydrogen and form a bond to 
the existing atom instead 
<li><b>colorByElement</b> (default <b>true</b>) &ndash;
color the modified atom and any newly added hydrogens 
<a href="colortables.html#element">by element</a>
<li><b>name</b> &ndash; new name for the modified atom;
if not given, the atom name is kept the same if the element stays
the same, or changed to an element-based name if the element is changed
<li><b>newRes</b> &ndash; whether to put the
modified atom and any attached hydrogens into a new residue.
<br>If <b>newRes</b> is <b>false</b> (default):
  <ul>
  <li>the <b>resName</b> option can be used to rename the residue 
  containing the modified atom
  <li>if <b>resName</b> is omitted, the residue containing the modified atom 
  will retain its original name
  <li>if <b>resName</b> is given as <b>auto</b>, the residue will be renamed
  according to the following rules:
    <ul>
    <li><b>UNK</b> for an amino acid in a bonded chain
    <li><b>N</b> for a nucleic acid in a bonded chain
    <li><b>UNL</b> otherwise
    </ul>
  </ul>
If <b>newRes</b> is <b>true</b>:
  <ul>
  <li>a name for the new residue can be supplied with the <b>resName</b> option
  <li>if <b>resName</b> is omitted or given as <b>auto</b>, 
  the new residue's name will be based on the atom's original residue type
  according to the following rules:
    <ul>
    <li><b>UNK</b> for an amino acid in a bonded chain
    <li><b>N</b> for a nucleic acid in a bonded chain
    <li><b>UNL</b> otherwise
    </ul>
  </ul>
</blockquote>

<a href="#top" class="nounder">&bull;</a>
<a name="join"></a>
<b>build join</b> <b>peptide</b>
&nbsp;<a href="atomspec.html"><i>atoms</i></a>&nbsp;
[&nbsp;<b>length</b>&nbsp;&nbsp;<i>bond-length</i>&nbsp;]
[&nbsp;<b>phi</b>&nbsp;&nbsp;<i>&phi;</i>&nbsp;]
[&nbsp;<b>omega</b>&nbsp;&nbsp;<i>&omega;</i>&nbsp;]
[&nbsp;<b>move</b>&nbsp;&nbsp;large&nbsp;|&nbsp;<b>small</b>&nbsp;|&nbsp;C&nbsp;|&nbsp;N&nbsp;]
<blockquote>
The <b>build join</b> command forms a covalent bond of the specified
geometry between two atomic models, combining the two models into one.
The atoms of one model are repositioned and incorporated into the other model; 
the original model will no longer exist. Thus, it may be a good idea
to <a href="save.html#session">save a session</a> beforehand, since
the join (along with other building actions) cannot be undone.
The related command <a href="combine.html"><b>combine</b></a> also combines
atomic models, but without forming a bond or changing the relative positions 
of the atoms.
</p><p>
Currently, only a <b>peptide</b> bond
can be formed, where <a href="atomspec.html"><i>atoms</i></a> must include
exactly one peptide C-terminal carbon atom C <b>&ndash;<i>OR</i>&ndash;</b>
N-terminal nitrogen atom N (not both) from one model, and from a second 
model, exactly one of whichever of those two atoms is not in the first.
These C and N atoms each must be bonded to only one carbon
(except N in proline or hydroxyproline can be bonded to two carbons);
however, it may also be bonded to hydrogen and/or OXT, and if so,
these atoms will be replaced as appropriate by the new peptide bond.
The default <b>length</b> for the new C-N bond is <b>1.330</b> &Aring; 
and the default <b>omega</b> angle (C&alpha;-C-N-C&alpha; dihedral) 
is <b>180.0</b>&deg;. There is no default for the <b>phi</b> angle
(C-N-C&alpha;-C dihedral). The model to <b>move</b> is repositioned 
and its atoms placed in the other model, using the chain ID from the 
other model. Options for which model to <b>move</b>:
<ul>
<li><b>large</b>
&ndash; the one with the greater number of  atoms
<li><b>small</b> (default)
&ndash; the one with fewer atoms
<li><b>C</b>
&ndash; the one containing the C atom to be bonded
<li><b>N</b> (default if the two models have equal numbers of atoms)
&ndash; the one containing the N atom to be bonded
</ul>
</blockquote>
<p>
The values of <b>omega</b> and <b>phi</b> (along with other peptide
torsion angles) are <a href="../attributes.html">attributes</a> 
of the amino acid residue containing the newly bonded N.
</p>
<hr>
<address>UCSF Resource for Biocomputing, Visualization, and Informatics /
June 2022</address>
</body></html>
