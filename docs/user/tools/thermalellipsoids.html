<html>

<!--
=== UCSF ChimeraX Copyright ===
Copyright 2016 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  For details see:
http://www.rbvi.ucsf.edu/chimerax/docs/licensing.html
This notice must be embedded in or attached to all copies,
including partial copies, of the software or any revisions
or derivations thereof.
=== UCSF ChimeraX Copyright ===
-->

<head>
<link rel="stylesheet" type="text/css" href="../userdocs.css" />
<title>Tool: Thermal Ellipsoids</title>
<style>@media (prefers-color-scheme: dark) { :root { color-scheme: dark; } }</style>
</head><body>

<a name="top"></a>
<a href="../index.html">
<img width="60px" src="../ChimeraX-docs-icon.svg" alt="ChimeraX docs icon"
class="clRighticon" title="User Guide Index"/></a>

<h3><a href="../index.html#tools">Tool</a>: Thermal Ellipsoids</h3>
<p>
<b>Thermal Ellipsoids</b> shows atomic anisotropic B-factors
as ellipsoids, their principal axes, and/or their principal ellipses.
These special depictions are created only for atoms with anisotropic
B-factor information, and can only be shown for atoms that are also displayed.
Anisotropic B-factors are read from the input coordinate file
(from ANISOU records in a PDB file or the analogous in CIF/mmCIF)
and are included with only certain high-resolution structures.
<!-- example structures: 1fye 1a2p -->
See also:
<a href="axesplanes.html"><b>Axes/Planes/Centroids</b></a>,
<a href="render.html"><b>Render by Attribute</b></a>,
<a href="../commands/measure.html#inertia"><b>measure inertia</b></a>,
<a href="../commands/open.html#object">3D object formats</a>,
the <a href="https://www.rbvi.ucsf.edu/chimerax/features.html#aniso"
target="_blank">ChimeraX thermal ellipsoids highlight</a>
</p><p>
The <b>Thermal Ellipsoids</b> tool can be started from the
<b>Structure Analysis</b> section of the <b>Tools</b> menu and
can be manipulated like other panels
(<a href="../window.html#panels">more...</a>).
It is also implemented as the
<a href="../commands/aniso.html"><b>aniso</b></a> command.
Anisotropic B-factor depictions are
saved in <a href="../commands/save.html#session">sessions</a>.
</p>

<a name="settings"></a>
<p class="nav">
[<a href="#top">back to top: Thermal Ellipsoids</a>]
</p>
<h3>Display Settings</h3>
<p>
Ellipsoid axes and radii correspond to the eigenvectors and eigenvalues
of the atomic mean-square displacement matrix.
The radii are proportional to the root-mean-square displacements (RMSDs),
the square roots of the eigenvalues.
<b>Display tip</b>: Since the ellipsoids may be obscured when atoms are shown as
balls or spheres, using a thin stick representation is recommended
(see <a href="../commands/style.html"><b>style</b></a> and
<a href="../commands/size.html"><b>size</b></a>).
</p>
<a name="settings1"></a>
<ul class="none">
<li><b>Scale factor</b> (default <b>1</b>, no scaling)
&ndash; controls ellipsoid size, where the unscaled ellipsoid radii
equal the atomic RMSDs along the ellipsoid axes
<li><b>Smoothing level</b> (default <b>3</b>)
&ndash; controls how many planar facets are used to draw ellipsoids and
ellipses; higher values give smaller facets and a smoother appearance
<li><b>Set scale factor for probability (%)</b> [<i>P</i>]
&ndash; automatically fills in the <b>Scale factor</b> field
for a specified % probability <i>P</i>
(press return after typing in a value;
<i>P</i> must be &ge; 0% and &lt; 100%)
</ul>
The <b>Preset</b> menu in <b>Thermal Ellipsoids</b> provides quick
access to several <a href="#presets">predefined combinations</a>
of the following options:
<ul>
<a name="settings2"></a>
<li><b>Depict ellipsoids</b> &ndash; whether to show ellipsoids
  <ul>
  <li><b>Color</b> 
&ndash; whether to <b>use atom color</b> or that in the color well 
(click to change the color interactively)
  <li><b>Transparency</b> (a menu including <b>same as color</b>
  and several percentage transparency options)
  </ul>
<li><b>Depict principal axes</b>
&ndash; whether to show ellipsoid principal axes
  <ul>
  <li><b>Color</b>
&ndash; whether to <b>use atom color</b> or that in the color well 
(click to change the color interactively)
  <li><b>Length factor</b> (default <b>1.5</b>)
  &ndash; length of principal axis depictions relative to ellipsoid size
  <li><b>Thickness</b> (default <b>0.01</b> &Aring;)
  &ndash; thickness of principal axis depictions (dimensions perpendicular to length)
  </ul>
<li><b>Depict principal ellipses</b>
&ndash; whether to show ellipsoid principal ellipses
  <ul>
  <li><b>Color</b>
&ndash; whether to <b>use atom color</b> or that in the color well 
(click to change the color interactively)
  <li><b>Size factor</b> (default <b>1.0</b>)
  &ndash; size of principal ellipse depictions relative to ellipsoid size
  <li><b>Thickness</b> (default <b>0.02</b> &Aring;)
  &ndash; thickness of principal ellipse depictions
  </ul>
</ul>
Clicking <b>Show</b> or pressing return after entering a value 
creates the depictions; clicking <b>Hide</b> removes them.
When the <b>Restrict Show/Hide...</b> option is on and atoms are
<a href="../selection.html">selected</a>,
showing and hiding will affect only the depictions of the
<a href="../selection.html">selected</a> atoms.
Otherwise, clicking <b>Show</b> removes any pre-existing depictions
and generates new ones for the currently displayed atoms.
</p>

<a name="presets"></a>
<p class="nav">
[<a href="#top">back to top: Thermal Ellipsoids</a>]
</p>
<h3>Thermal Ellipsoid Presets</h3>
<p>
The <b>Presets</b> menu in <b>Thermal Ellipsoids</b> includes several
predefined combinations of <a href="#settings2">style settings</a>.
Those listed below are built-in, and more can be defined by the user.
Presets do not include <a href="#settings1">scaling and smoothing
settings</a>, which are specified independently.
Choosing a preset from the menu applies its settings immediately.
See also: <a href="../commands/aniso.html#preset"><b>aniso preset</b></a>
</p>
<ul>
<li><b>axes</b>
&ndash; axes only (length factor 1.0)
<!--
showEllipsoid false, axisFactor 1.0, ellipseFactor none
-->
<li><b>ellipses</b>
&ndash; ellipses only (size factor 1.0)
<!--
showEllipsoid false, axisFactor none, ellipseFactor 1.0, color from atoms
-->
<li><b>octant</b>
&ndash; ellipsoids with black ellipses (size factor 1.01)
<!--
showEllipsoid true, ellipseFactor 1.01, ellipseColor black
-->
<li><b>simple</b>
&ndash; ellipsoids only, color from atoms
<!--
showEllipsoid true, axisFactor none, ellipseFactor none
-->
<li><b>simple-axes</b>
&ndash; ellipsoids with axes (length factor 1.5)
<!--
showEllipsoid true, axisFactor 1.5
-->
<li><b>snowglobe-axes</b>
&ndash; white half-transparent ellipsoids with axes (length factor 0.99)
<!--
showEllipsoid true, color white, transparency 0.5, axisFactor 0.99
-->
<li><b>snowglobe-ellipses</b>
&ndash; white half-transparent ellipsoids with ellipses (size factor 0.99)
<!--
showEllipsoid true, color white, transparency 0.5, ellipseFactor 0.99
-->
<li><b>Preset from current settings...</b>
save a custom preset with the current <a href="#settings2">style settings</a>
<li><b>Delete user preset...</b>
remove a previously user-defined preset
</ul>

<hr>
<address>UCSF Resource for Biocomputing, Visualization, and Informatics /
May 2025</address>
</body></html>
