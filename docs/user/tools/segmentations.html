<html>
  <!--
=== UCSF ChimeraX Copyright ===
Copyright 2016 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  For details see:
http://www.rbvi.ucsf.edu/chimerax/docs/licensing.html
This notice must be embedded in or attached to all copies,
including partial copies, of the software or any revisions
or derivations thereof.
=== UCSF ChimeraX Copyright ===
-->

  <head>
    <link rel="stylesheet" type="text/css" href="../userdocs.css" />
    <title>Tool: Segmentations</title>
    <style>
      @media (prefers-color-scheme: dark) {
        :root {
          color-scheme: dark;
        }
      }
    </style>
  </head>
  <body>
    <a name="top"></a>
    <a href="../index.html">
      <img
        width="60px"
        src="../ChimeraX-docs-icon.svg"
        alt="ChimeraX docs icon"
        class="clRighticon"
        title="User Guide Index"
    /></a>

    <table class="clRight">
      <tr>
        <td>
          <a href="segmentations.png"
            ><img
              class="outline"
              src="segmentations.png"
              title="click to enlarge..."
              alt="chest CT with segmentations"
              width="600px"
          /></a>
        </td>
      </tr>
      <tr>
        <td align="center">
          <font size="-1">
            <a href="../dicom-quickref.html#data">Chest CT dataset</a> with
            several axial slices segmented</font
          >
        </td>
      </tr>
    </table>

    <h3><a href="../index.html#tools">Tool</a>: Segmentations</h3>
    <p>
      The <b>Segmentations</b> tool allows interactive manual segmentation of
      medical images and other <a href="volumeviewer.html">volume data</a>
      plane by plane, or with a spherical cursor in the 3D view or in
      <a href="../vr.html">virtual reality</a>. Segmentations are additional
      volume models displayed as surfaces that delineate regions of arbitrary
      shape within the image dataset; for medical images, they typically
      represent anatomic structures or lesions such as tumors. Multiple
      segmentation models can be defined from the same image dataset.
    </p>
    <p>
      For semiautomated segmentation of cryo-electron microscopy density maps,
      see the <a href="segment.html"><b>Segment Map</b></a> tool instead.
    </p>
    <p>
      The <b>Segmentations</b> tool can be started from the
      <b>Volume Data</b> section of the <b>Tools</b> menu (<a
        href="../window.html#panels"
        >more...</a
      >). Some of its functions are also implemented as the
      <a href="../commands/segmentations.html"><b>segmentations</b></a> command.
      See also: <a href="downloaddicom.html"><b>Download DICOM</b></a
      >, <a href="volumeviewer.html"><b>Volume Viewer</b></a
      >, <a href="maperaser.html"><b>Map Eraser</b></a
      >, <a href="../commands/color.html#zone"><b>color zone</b></a
      >, <a href="../commands/volume.html#mask"><b>volume mask</b></a
      >, <a href="../commands/segmentation.html"><b>segmentation</b></a
      >,
      <a
        href="https://www.rbvi.ucsf.edu/chimerax/data/dicom-tutorials/dicom-segmentations.html"
        >DICOM segmentation tutorial</a
      >, <a href="../dicom-quickref.html">ChimeraX DICOM Reference</a>,
      <a href="medicalimage.html#mousemodes"><b>Medical Image</b></a> toolbar
      icons:
      <a href="medicalimage.html#mousemodes" title="Medical Image Toolbar...">
        <img class="icon" border="1" src="mouse-icons/mouse_small.svg"
      /></a>
      <a href="medicalimage.html#mousemodes" title="Medical Image Toolbar...">
        <img
          class="icon"
          border="1"
          src="mouse-icons/right_controller_small.svg"
      /></a>
    </p>

    <a name="dialog"></a>
    <p class="nav">[<a href="#top">back to top: Segmentations</a>]</p>
    <h3>Dialog</h3>
    <p>
      Starting the <b>Segmentations</b> tool automatically sets the view layout
      according to the tool's
      <a href="#settings-general"><b>General</b> settings</a>. See also:
      <a href="../commands/ui.html#view"><b>ui view</b></a>
    </p>
    <p>
      <a name="layout"></a>
      The <b>View layout</b> can be switched among:
    </p>
    <ul>
      <li>
        <b>2 x 2 (desktop)</b> &ndash; axial slice and 3D view on the top,
        coronal and sagittal slice views on the bottom
      </li>

      <li>
        <b>3D over slices (desktop)</b> &ndash; 3D across the top, the three
        slice views across the bottom
      </li>

      <li>
        <b>3D beside slices (desktop)</b> &ndash; the three slice views on the
        left, 3D on the right
      </li>

      <li><b>3D only (desktop)</b></li>
      <li><b>3D only (VR)</b></li>
    </ul>
    <p>
      The <b>Model</b> of interest (the medical image to segment and thus to
      show in the slice views) should be chosen from the list of currently open
      models. Choosing a different model does not change the 3D view; models can
      be shown/hidden there using any of the usual mechanisms, namely the
      <a href="modelpanel.html"><b>Model Panel</b></a> and/or
      <a href="../commands/show.html"><b>show/hide</b></a> commands.
    </p>
    <p>
      The <b>Plane guidelines</b> option controls whether each slice view should
      contain crosshairs showing the positions of the other slice views.
    </p>
    <p>
      <a name="range"></a>
      The <b>Restrict segmentation to intensity range</b> option allows limiting
      the range of data values that can be added to a segmentation model during
      <a href="#editing">interactive editing</a>; only those pixels with data
      values within the specified range will be added even when a larger area is
      swept out by the segmentation cursor.
    </p>
    <p>
      The <a href="volumeviewer.html#threshold">thresholds</a> of each view (how
      values map to intensities) can be adjusted interactively in the
      <a href="volumeviewer.html"><b>Volume Viewer</b></a> tool.
    </p>

    <a name="editing"></a>
    <p class="nav">[<a href="#top">back to top: Segmentations</a>]</p>
    <h3>Creating and Editing Segmentations</h3>
    <p>
      Segmentation models (if any) are listed in the dialog. Clicking
      <b>Add</b> creates a new segmentation model, and any segmentation in the
      list can be can be chosen (highlighted) with the mouse. The currently
      highlighted segmentation is the one that will be populated using the
      segmentation cursor in the slice views. See
      <a href="../commands/ui.html#navigation">slice navigation</a> for how to
      scroll through, zoom, and translate the slice views. Clicking
      <b>Remove</b> deletes the chosen segmentation, whereas <b>Save</b> brings
      up a dialog for saving the segmentation to a file. If the
      <a href="../dicom/dicom.html">DICOM</a> file type is chosen, the
      segmentation is saved as the SEG modality with the associated metadata, if
      any. Other medical-image formats (<a
        href="https://nifti.nimh.nih.gov/"
        target="_blank"
        ><b>NIfTI</b></a
      >,
      <a href="https://teem.sourceforge.net/nrrd/" target="_blank"
        ><b>NRRD</b></a
      >) will not include the metadata.
    </p>
    <p>
      In the slice views, the segmentation cursor is shown as a red circle; left
      mouse click-drag sweeps out an area in the currently displayed data plane,
      whereas additionally pressing Shift erases the corresponding area from the
      segmentation. Shift-scroll adjusts the segmentation cursor size. The area
      swept out by the segmentation cursor in a slice view will be added to the
      current segmentation, unless further restricted by
      <a href="#range">intensity range</a>. These slice-view mouse mode
      assignments are listed in the
      <a href="#settings-mouse2d"><b>Mouse (2D Slices)</b> settings</a>
      but cannot be changed currently.
    </p>
    <p>
      Segmentations can also be edited in the desktop 3D view according to the
      <a href="#settings-mouse3d"><b>Mouse (3D)</b> settings</a>
      and in <a href="../vr.html">virtual reality</a> according to the
      <a href="#settings-vr"><b>VR Controller</b> settings</a>
    </p>
    <p>
      Clicking <b>Help</b> opens this page in the
      <a href="helpviewer.html"><b>Help Viewer</b></a
      >.
    </p>

    <a name="settings"></a>
    <p class="nav">[<a href="#top">back to top: Segmentations</a>]</p>
    <h3>Segmentations Settings (Preferences)</h3>
    <p>
      Choosing <b>Settings...</b> from the <b>Segmentations</b>
      <a href="../window.html#context-menu">context menu</a> or clicking the
      &ldquo;gear&rdquo; icon near the top right corner of the
      <b>Segmentations</b>
      dialog shows its settings in a separate window, with sections:
    </p>
    <ul>
      <li>
        <a href="#settings-general"><b>General</b></a>
      </li>
      <li>
        <a href="#settings-mouse2d"><b>Mouse (2D Slices)</b></a>
      </li>
      <li>
        <a href="#settings-mouse3d"><b>Mouse (3D)</b></a>
      </li>
      <li>
        <a href="#settings-vr"><b>VR Controller</b></a>
      </li>
    </ul>
    <p>
      The settings window can be manipulated like other panels in the ChimeraX
      interface (<a href="../window.html#panels">more...</a>).
    </p>
    <p>
      <b>Save</b> saves the current settings as
      <a href="../preferences.html#other">preferences</a>, <b>Reset</b> replaces
      the current settings with the initial &ldquo;factory&rdquo; defaults, and
      <b>Restore</b> restores values that were saved previously.
    </p>

    <a name="settings-general"></a>
    <p>
      <a href="#settings" class="nounder"><b>&larr;</b></a>
      <b>General</b>
      &ndash; tool-associated graphics window and device behaviors
    </p>
    <ul class="none">
      <li>
        <b>Default layout</b> &ndash; which of the following
        <a href="#layout">layouts</a> to use when the tool is started:
        <ul>
          <li>
            <b>2 x 2 (desktop)</b> (initial default) &ndash; axial slice and 3D
            view on the top, coronal and sagittal slice views on the bottom
          </li>

          <li>
            <b>3D over slices (desktop)</b> &ndash; 3D across the top, the three
            slice views across the bottom
          </li>

          <li>
            <b>3D beside slices (desktop)</b> &ndash; the three slice views on
            the left, 3D on the right
          </li>

          <li><b>3D only (desktop)</b></li>
          <li><b>3D only (VR)</b></li>
        </ul>
      </li>

      <li>
        <b>Segmentation opacity</b> (initial default <b>80</b>%) &ndash; opacity
        of segmentation surfaces; transparency = 100% &ndash; opacity
      </li>

      <li>
        <b>Set 3D mouse modes when the desktop 3D-only layout is chosen</b>
        &ndash; whether to assign mouse buttons automatically according to the
        <a href="#settings-mouse3d"><b>Mouse (3D)</b> settings</a>
        when the desktop 3D-only <a href="#layout">layout</a> is chosen
        (returning to prior assignments when a different
        <a href="#layout">layout</a> is chosen or the tool is closed)
      </li>

      <li>
        <b>Set VR controller modes when the VR layout is chosen</b> &ndash;
        whether to assign the <b><i>right</i></b> hand-controller buttons
        automatically according to the
        <a href="#settings-vr"><b>VR Controller</b> settings</a> when the VR
        <a href="#layout">layout</a> is chosen (returning to prior assignments
        when the tool is closed)
      </li>

      <li>
        <b>Start VR when the VR layout is chosen</b> &ndash; whether to start
        <a href="../vr.html">virtual reality</a> mode automatically when the VR
        <a href="#layout">layout</a> is chosen
      </li>
    </ul>

    <a name="settings-mouse2d"></a>
    <p>
      <a href="#settings" class="nounder"><b>&larr;</b></a>
      <b>Mouse (2D Slices)</b>
      &ndash; mouse assignments in the axial, coronal, and sagittal slice views.
    </p>

    <a name="settings-mouse3d"></a>
    <p>
      <a href="#settings" class="nounder"><b>&larr;</b></a>
      <b>Mouse (3D)</b>
      &ndash; mouse assignments in the desktop 3D view when the
      <a href="#settings-general"><b>General</b></a> option to
      <b>Set 3D mouse modes...</b> is on and the desktop 3D-only
      <a href="#layout">layout</a> is chosen. These assignments can be toggled
      on/off with the
      <a href="medicalimage.html#mousemodes"><b>Medical Image</b></a> toolbar
      icon
      <a href="medicalimage.html#mousemodes" title="Medical Image Toolbar...">
        <img class="icon" border="1" src="mouse-icons/mouse_small.svg" /></a
      >, where the &ldquo;off&rdquo; state restores the previous assignments.
    </p>

    <a name="settings-vr"></a>
    <p>
      <a href="#settings" class="nounder"><b>&larr;</b></a>
      <b>VR Controller</b>
      &ndash; assignments to the <b><i>right</i></b> hand controller when the
      <a href="#settings-general"><b>General</b></a> option to
      <b>Set VR controller modes...</b> is on and the VR 3D-only
      <a href="#layout">layout</a> is chosen. These assignments can be toggled
      on/off with the
      <a href="medicalimage.html#mousemodes"><b>Medical Image</b></a> toolbar
      icon
      <a href="medicalimage.html#mousemodes" title="Medical Image Toolbar...">
        <img
          class="icon"
          border="1"
          src="mouse-icons/right_controller_small.svg" /></a
      >, where the &ldquo;off&rdquo; state restores the previous assignments.
    </p>

    <hr />
    <address>
      UCSF Resource for Biocomputing, Visualization, and Informatics / May 2024
    </address>
  </body>
</html>
